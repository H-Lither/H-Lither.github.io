<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 第二届 newsctf · H-Lither</title><meta name="description" content="第二届 newsctf - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://example.com/atom.xml" title="H-Lither"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="H-Lither" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">第二届 newsctf</h1><div class="post-info">Jun 1, 2021</div><div class="post-content"><p>newsctf</p>
<p>除了Q神那道</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604201017689.png" alt="image-20210604201125709"></p>
<p>题目还算简单，不知道为啥没人做。。。。</p>
<h2 id="2021-6-1萌新赛-re-signin"><a href="#2021-6-1萌新赛-re-signin" class="headerlink" title="2021.6.1萌新赛-re_signin"></a>2021.6.1萌新赛-re_signin</h2><p>拿到文件解压，发现是个pyc文件。拿去反编译得到源码。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604201017689.png" alt="image-20210604201017689"></p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604201017689.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.7.4</span></span><br><span class="line"><span class="comment"># Python bytecode 3.8 (3413)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.8.6 (tags/v3.8.6:db45529, Sep 23 2020, 15:52:53) [MSC v.1927 64 bit (AMD64)]</span></span><br><span class="line"><span class="comment"># Embedded file name: /home/mumuzi/����/flag.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2021-05-28 16:16:08</span></span><br><span class="line"><span class="comment"># Size of source mod 2**32: 528 bytes</span></span><br><span class="line">flag = <span class="string">&#x27;xxxx&#123;xxxxxxxxxxxxxxxxxx&#125;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">c = [<span class="number">0</span>] * <span class="built_in">len</span>(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    c[i] = <span class="built_in">ord</span>(flag[i])</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(c)</span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line">        num = <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">100</span>)</span><br><span class="line">        nums = random.sample(num, <span class="number">22</span>)</span><br><span class="line">        numss = nums.copy()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums) - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums) - i - <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> nums[j] &gt; nums[(j + <span class="number">1</span>)]:</span><br><span class="line">                nums[j], nums[j + <span class="number">1</span>] = nums[(j + <span class="number">1</span>)], nums[j]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> count == c[t]:</span><br><span class="line">            print(numss)</span><br><span class="line">            t += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">24</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"><span class="comment"># okay decompiling flag.pyc</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>题目就是将冒泡排序的次数等于flag中字符的ascii码。</p>
<p>直接跑一次计数然后转chr输出就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">numss= [[<span class="number">73</span>, <span class="number">69</span>, <span class="number">60</span>, <span class="number">20</span>, <span class="number">64</span>, <span class="number">68</span>, <span class="number">99</span>, <span class="number">4</span>, <span class="number">36</span>, <span class="number">9</span>, <span class="number">91</span>, <span class="number">42</span>, <span class="number">75</span>, <span class="number">43</span>, <span class="number">8</span>, <span class="number">77</span>, <span class="number">55</span>, <span class="number">70</span>, <span class="number">84</span>, <span class="number">37</span>, <span class="number">3</span>, <span class="number">93</span>],</span><br><span class="line">     [<span class="number">85</span>, <span class="number">46</span>, <span class="number">47</span>, <span class="number">99</span>, <span class="number">58</span>, <span class="number">35</span>, <span class="number">83</span>, <span class="number">3</span>, <span class="number">57</span>, <span class="number">18</span>, <span class="number">52</span>, <span class="number">17</span>, <span class="number">97</span>, <span class="number">16</span>, <span class="number">6</span>, <span class="number">51</span>, <span class="number">84</span>, <span class="number">62</span>, <span class="number">1</span>, <span class="number">41</span>, <span class="number">88</span>, <span class="number">87</span>],</span><br><span class="line">     [<span class="number">97</span>, <span class="number">34</span>, <span class="number">31</span>, <span class="number">80</span>, <span class="number">19</span>, <span class="number">57</span>, <span class="number">10</span>, <span class="number">84</span>, <span class="number">4</span>, <span class="number">50</span>, <span class="number">43</span>, <span class="number">63</span>, <span class="number">65</span>, <span class="number">88</span>, <span class="number">30</span>, <span class="number">72</span>, <span class="number">21</span>, <span class="number">36</span>, <span class="number">27</span>, <span class="number">41</span>, <span class="number">86</span>, <span class="number">79</span>],</span><br><span class="line">     [<span class="number">31</span>, <span class="number">23</span>, <span class="number">68</span>, <span class="number">67</span>, <span class="number">30</span>, <span class="number">47</span>, <span class="number">27</span>, <span class="number">40</span>, <span class="number">73</span>, <span class="number">63</span>, <span class="number">11</span>, <span class="number">89</span>, <span class="number">18</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">74</span>, <span class="number">88</span>, <span class="number">38</span>, <span class="number">8</span>, <span class="number">20</span>, <span class="number">50</span>, <span class="number">83</span>],</span><br><span class="line">     [<span class="number">88</span>, <span class="number">5</span>, <span class="number">85</span>, <span class="number">82</span>, <span class="number">36</span>, <span class="number">74</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">40</span>, <span class="number">55</span>, <span class="number">95</span>, <span class="number">8</span>, <span class="number">84</span>, <span class="number">47</span>, <span class="number">96</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">77</span>, <span class="number">67</span>, <span class="number">26</span>, <span class="number">39</span>],</span><br><span class="line">     [<span class="number">54</span>, <span class="number">53</span>, <span class="number">0</span>, <span class="number">37</span>, <span class="number">66</span>, <span class="number">91</span>, <span class="number">39</span>, <span class="number">38</span>, <span class="number">57</span>, <span class="number">6</span>, <span class="number">47</span>, <span class="number">28</span>, <span class="number">49</span>, <span class="number">92</span>, <span class="number">29</span>, <span class="number">85</span>, <span class="number">88</span>, <span class="number">84</span>, <span class="number">90</span>, <span class="number">13</span>, <span class="number">35</span>, <span class="number">52</span>],</span><br><span class="line">     [<span class="number">80</span>, <span class="number">18</span>, <span class="number">26</span>, <span class="number">91</span>, <span class="number">10</span>, <span class="number">52</span>, <span class="number">11</span>, <span class="number">99</span>, <span class="number">85</span>, <span class="number">75</span>, <span class="number">60</span>, <span class="number">48</span>, <span class="number">36</span>, <span class="number">74</span>, <span class="number">55</span>, <span class="number">51</span>, <span class="number">86</span>, <span class="number">49</span>, <span class="number">89</span>, <span class="number">29</span>, <span class="number">82</span>, <span class="number">16</span>],</span><br><span class="line">     [<span class="number">35</span>, <span class="number">70</span>, <span class="number">42</span>, <span class="number">44</span>, <span class="number">18</span>, <span class="number">65</span>, <span class="number">84</span>, <span class="number">71</span>, <span class="number">26</span>, <span class="number">14</span>, <span class="number">38</span>, <span class="number">28</span>, <span class="number">21</span>, <span class="number">86</span>, <span class="number">20</span>, <span class="number">54</span>, <span class="number">30</span>, <span class="number">11</span>, <span class="number">66</span>, <span class="number">10</span>, <span class="number">69</span>, <span class="number">77</span>],</span><br><span class="line">     [<span class="number">71</span>, <span class="number">25</span>, <span class="number">43</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">6</span>, <span class="number">33</span>, <span class="number">44</span>, <span class="number">5</span>, <span class="number">30</span>, <span class="number">32</span>, <span class="number">18</span>, <span class="number">47</span>, <span class="number">13</span>, <span class="number">76</span>, <span class="number">8</span>, <span class="number">83</span>, <span class="number">87</span>, <span class="number">57</span>, <span class="number">26</span>, <span class="number">16</span>, <span class="number">19</span>],</span><br><span class="line">     [<span class="number">29</span>, <span class="number">51</span>, <span class="number">7</span>, <span class="number">62</span>, <span class="number">94</span>, <span class="number">32</span>, <span class="number">57</span>, <span class="number">1</span>, <span class="number">71</span>, <span class="number">84</span>, <span class="number">92</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">56</span>, <span class="number">52</span>, <span class="number">40</span>, <span class="number">80</span>, <span class="number">98</span>, <span class="number">44</span>, <span class="number">82</span>, <span class="number">33</span>],</span><br><span class="line">     [<span class="number">67</span>, <span class="number">14</span>, <span class="number">93</span>, <span class="number">91</span>, <span class="number">78</span>, <span class="number">80</span>, <span class="number">7</span>, <span class="number">37</span>, <span class="number">10</span>, <span class="number">82</span>, <span class="number">38</span>, <span class="number">83</span>, <span class="number">23</span>, <span class="number">27</span>, <span class="number">17</span>, <span class="number">76</span>, <span class="number">74</span>, <span class="number">18</span>, <span class="number">66</span>, <span class="number">24</span>, <span class="number">99</span>, <span class="number">43</span>],</span><br><span class="line">     [<span class="number">29</span>, <span class="number">56</span>, <span class="number">44</span>, <span class="number">54</span>, <span class="number">70</span>, <span class="number">31</span>, <span class="number">10</span>, <span class="number">38</span>, <span class="number">8</span>, <span class="number">85</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">32</span>, <span class="number">49</span>, <span class="number">2</span>, <span class="number">21</span>, <span class="number">50</span>, <span class="number">5</span>, <span class="number">25</span>, <span class="number">48</span>, <span class="number">90</span>, <span class="number">84</span>],</span><br><span class="line">     [<span class="number">23</span>, <span class="number">33</span>, <span class="number">90</span>, <span class="number">7</span>, <span class="number">42</span>, <span class="number">71</span>, <span class="number">25</span>, <span class="number">58</span>, <span class="number">5</span>, <span class="number">47</span>, <span class="number">54</span>, <span class="number">18</span>, <span class="number">97</span>, <span class="number">72</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">68</span>, <span class="number">64</span>, <span class="number">76</span>, <span class="number">85</span>, <span class="number">69</span>, <span class="number">49</span>],</span><br><span class="line">     [<span class="number">77</span>, <span class="number">67</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">35</span>, <span class="number">6</span>, <span class="number">56</span>, <span class="number">94</span>, <span class="number">81</span>, <span class="number">23</span>, <span class="number">78</span>, <span class="number">50</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">28</span>, <span class="number">69</span>, <span class="number">43</span>, <span class="number">91</span>, <span class="number">82</span>, <span class="number">72</span>, <span class="number">99</span>, <span class="number">38</span>],</span><br><span class="line">     [<span class="number">20</span>, <span class="number">47</span>, <span class="number">52</span>, <span class="number">27</span>, <span class="number">73</span>, <span class="number">64</span>, <span class="number">9</span>, <span class="number">62</span>, <span class="number">3</span>, <span class="number">57</span>, <span class="number">2</span>, <span class="number">97</span>, <span class="number">44</span>, <span class="number">35</span>, <span class="number">89</span>, <span class="number">10</span>, <span class="number">18</span>, <span class="number">29</span>, <span class="number">58</span>, <span class="number">56</span>, <span class="number">74</span>, <span class="number">84</span>],</span><br><span class="line">     [<span class="number">66</span>, <span class="number">11</span>, <span class="number">76</span>, <span class="number">91</span>, <span class="number">70</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">75</span>, <span class="number">32</span>, <span class="number">71</span>, <span class="number">44</span>, <span class="number">48</span>, <span class="number">88</span>, <span class="number">20</span>, <span class="number">98</span>, <span class="number">97</span>, <span class="number">79</span>, <span class="number">63</span>, <span class="number">47</span>, <span class="number">78</span>, <span class="number">60</span>, <span class="number">81</span>],</span><br><span class="line">     [<span class="number">43</span>, <span class="number">13</span>, <span class="number">70</span>, <span class="number">23</span>, <span class="number">31</span>, <span class="number">69</span>, <span class="number">52</span>, <span class="number">30</span>, <span class="number">2</span>, <span class="number">78</span>, <span class="number">0</span>, <span class="number">37</span>, <span class="number">73</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">1</span>, <span class="number">51</span>, <span class="number">62</span>, <span class="number">25</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">87</span>],</span><br><span class="line">     [<span class="number">24</span>, <span class="number">86</span>, <span class="number">29</span>, <span class="number">0</span>, <span class="number">93</span>, <span class="number">51</span>, <span class="number">53</span>, <span class="number">47</span>, <span class="number">16</span>, <span class="number">40</span>, <span class="number">94</span>, <span class="number">98</span>, <span class="number">88</span>, <span class="number">64</span>, <span class="number">41</span>, <span class="number">83</span>, <span class="number">44</span>, <span class="number">35</span>, <span class="number">45</span>, <span class="number">75</span>, <span class="number">17</span>, <span class="number">46</span>],</span><br><span class="line">     [<span class="number">33</span>, <span class="number">12</span>, <span class="number">63</span>, <span class="number">77</span>, <span class="number">25</span>, <span class="number">24</span>, <span class="number">47</span>, <span class="number">58</span>, <span class="number">6</span>, <span class="number">89</span>, <span class="number">97</span>, <span class="number">27</span>, <span class="number">21</span>, <span class="number">96</span>, <span class="number">92</span>, <span class="number">50</span>, <span class="number">82</span>, <span class="number">76</span>, <span class="number">5</span>, <span class="number">62</span>, <span class="number">56</span>, <span class="number">44</span>],</span><br><span class="line">     [<span class="number">12</span>, <span class="number">36</span>, <span class="number">16</span>, <span class="number">44</span>, <span class="number">19</span>, <span class="number">62</span>, <span class="number">43</span>, <span class="number">80</span>, <span class="number">58</span>, <span class="number">98</span>, <span class="number">69</span>, <span class="number">97</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">49</span>, <span class="number">26</span>, <span class="number">70</span>, <span class="number">34</span>, <span class="number">53</span>, <span class="number">13</span>, <span class="number">65</span>, <span class="number">48</span>],</span><br><span class="line">     [<span class="number">51</span>, <span class="number">74</span>, <span class="number">76</span>, <span class="number">98</span>, <span class="number">33</span>, <span class="number">78</span>, <span class="number">44</span>, <span class="number">45</span>, <span class="number">4</span>, <span class="number">65</span>, <span class="number">99</span>, <span class="number">84</span>, <span class="number">80</span>, <span class="number">93</span>, <span class="number">37</span>, <span class="number">56</span>, <span class="number">77</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">94</span>, <span class="number">52</span>, <span class="number">88</span>],</span><br><span class="line">     [<span class="number">80</span>, <span class="number">38</span>, <span class="number">88</span>, <span class="number">66</span>, <span class="number">7</span>, <span class="number">40</span>, <span class="number">70</span>, <span class="number">24</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">76</span>, <span class="number">18</span>, <span class="number">57</span>, <span class="number">73</span>, <span class="number">58</span>, <span class="number">83</span>, <span class="number">33</span>, <span class="number">17</span>, <span class="number">89</span>, <span class="number">69</span>, <span class="number">77</span>, <span class="number">67</span>],</span><br><span class="line">     [<span class="number">18</span>, <span class="number">53</span>, <span class="number">14</span>, <span class="number">24</span>, <span class="number">94</span>, <span class="number">42</span>, <span class="number">61</span>, <span class="number">75</span>, <span class="number">62</span>, <span class="number">60</span>, <span class="number">73</span>, <span class="number">2</span>, <span class="number">65</span>, <span class="number">48</span>, <span class="number">80</span>, <span class="number">23</span>, <span class="number">44</span>, <span class="number">91</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">31</span>, <span class="number">71</span>],</span><br><span class="line">     [<span class="number">16</span>, <span class="number">54</span>, <span class="number">87</span>, <span class="number">75</span>, <span class="number">8</span>, <span class="number">23</span>, <span class="number">33</span>, <span class="number">56</span>, <span class="number">22</span>, <span class="number">63</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">25</span>, <span class="number">6</span>, <span class="number">84</span>, <span class="number">80</span>, <span class="number">4</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">42</span>, <span class="number">14</span>, <span class="number">43</span>]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(numss)):</span><br><span class="line">    nums=numss[k]</span><br><span class="line">    count=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums) - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums) - i - <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> nums[j] &gt; nums[(j + <span class="number">1</span>)]:</span><br><span class="line">                nums[j], nums[j + <span class="number">1</span>] = nums[(j + <span class="number">1</span>)], nums[j]</span><br><span class="line">                count+=<span class="number">1</span></span><br><span class="line">    print(<span class="built_in">chr</span>(count),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#synt&#123;jrypbzr_gb_arjfpgs&#125;</span></span><br></pre></td></tr></table></figure>
<p>发现字符串怪怪的，有点像凯撒，拿去，发现偏移为13出现flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#flag&#123;welcome_to_newsctf&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2021-6-1萌新赛-1-1的签到题"><a href="#2021-6-1萌新赛-1-1的签到题" class="headerlink" title="2021.6.1萌新赛-1+1的签到题"></a>2021.6.1萌新赛-1+1的签到题</h2><p>ida打开发现，upx加壳了。</p>
<p>使用upx -d 脱壳，</p>
<p>再用ida打开。发现，程序写得乱糟糟的。。</p>
<p>首先是一个换表base58.</p>
<p>？？？又得到一个表</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604201017689.png" alt="image-20210604203829654"></p>
<p>发现，还有两串奇怪得编码</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604201017689.png" alt="image-20210604203906334"></p>
<p>想到上面得到了一串表好像base64，再拿去解码。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604201017689.png" alt="image-20210604204113518"></p>
<p>secret2能解码出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!!C0ngr4Tu1atl0n5!!</span><br></pre></td></tr></table></figure>
<p>尝试发现，secret1还是用最开始的那个表解base58</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604204223094.png" alt="image-20210604204223094"></p>
<p>然后审计程序，发现还有一处输入，发现是利用srand（）生成一个种子，然后随机出来的值，异或操作等于一个固定的值，那么我们可以动调或者写源码调用这个种子生成的随机值，然后异或，得到最后的值。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604204526272.png" alt="image-20210604204526272"></p>
<p>得到两个数分别为 198469000 395774304</p>
<p>然后算出a1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0x453473793fv6=<span class="number">198469000</span></span><br><span class="line">v7=<span class="number">395774304</span>*<span class="number">20</span></span><br><span class="line">print(<span class="built_in">hex</span>(v6^v7 ^ <span class="number">0x235FFFA864</span> ^ <span class="number">0x67B7940F53</span>))</span><br><span class="line">print(long_to_bytes(<span class="number">0x453473793f</span>))</span><br><span class="line"><span class="comment">#b&#x27;E4sy?&#x27;</span></span><br></pre></td></tr></table></figure>
<p>合并起来就是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#flag&#123;E4sy?_Up_t0_Y0u!!!C0ngr4Tu1atl0n5!!&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2021-6-1萌新赛-开门啊-2"><a href="#2021-6-1萌新赛-开门啊-2" class="headerlink" title="2021.6.1萌新赛-开门啊-2"></a>2021.6.1萌新赛-开门啊-2</h2><p>安卓逆向，</p>
<p>so层分析</p>
<p>总得来说就是一个输入用户名，注册码，，且用户名用于注册码的生成.</p>
<p>主要分析三个函数</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604210315855.png" alt="image-20210604210315855"></p>
<p>前两个只是赋值，</p>
<p>第三个才是关键函数，</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604210353909.png" alt="image-20210604210353909"></p>
<p>点击要等于5次，此时gV3=15且tom1()要返回1，</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604210432683.png" alt="image-20210604210432683"></p>
<p>tom1只是将</p>
<p>输入的字符串1异或后与<img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604210547492.png" alt="image-20210604210547492">这个数组前十四位进行比较。</p>
<p>全相同则返回一。</p>
<p>tom2()</p>
<p>函数则是对注册码的比较</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604210729043.png" alt="image-20210604210729043"></p>
<p>讲第一个输入的字符串，逐个异或后，与一个数组进行逐个比较。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dd=[ <span class="number">0x3B</span>, <span class="number">0x39</span>, <span class="number">0x39</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x33</span>, <span class="number">0x31</span>, <span class="number">0x4F</span>, <span class="number">0x33</span>, <span class="number">0x33</span>,</span><br><span class="line">  <span class="number">0x32</span>, <span class="number">0x32</span>, <span class="number">0x32</span>, <span class="number">0x31</span>]</span><br><span class="line">key=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dd)):</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x7f</span>):</span><br><span class="line">        <span class="keyword">if</span> (k+i)^<span class="number">15</span>==dd[i]:</span><br><span class="line">            key.append(k)</span><br><span class="line">dd2=[ <span class="number">0x52</span>, <span class="number">0x59</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x0D</span>, <span class="number">0x0F</span>, <span class="number">0x0D</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x01</span>, <span class="number">0x03</span>,</span><br><span class="line">  <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x45</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dd2)):</span><br><span class="line">    print(<span class="built_in">chr</span>(dd2[i]^key[i%<span class="built_in">len</span>(key)]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#flag&#123;756912374567645&#125;</span></span><br></pre></td></tr></table></figure>


<h2 id="2021-6-1萌新赛-开门啊-1"><a href="#2021-6-1萌新赛-开门啊-1" class="headerlink" title="2021.6.1萌新赛-开门啊-1"></a>2021.6.1萌新赛-开门啊-1</h2><p>程序有点绕，不过动调后可以得到，g.0=15,然后输入的字符串，每一个字符的ascii加15。然后对比下图的那个数组。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604211546654.png" alt="image-20210604211546654"></p>
<p>异或后然后再减去15就是输入的字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;16498356746434&#125;</span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2021/06/03/%E8%93%9D%E5%B8%BD%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/" class="prev">PREV</a><a href="/2021/06/01/DozerCTF-2021/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2021 <a href="http://example.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>