<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> DozerCTF 2021 · H-Lither</title><meta name="description" content="DozerCTF 2021 - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://example.com/atom.xml" title="H-Lither"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="H-Lither" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">DozerCTF 2021</h1><div class="post-info">Jun 1, 2021</div><div class="post-content"><h1 id="DozerCTF-2021"><a href="#DozerCTF-2021" class="headerlink" title="DozerCTF 2021"></a>DozerCTF 2021</h1><p>rank：1st</p>
<p>周末打了这个比赛，我AK了逆向方向，最后两道一血，其中一道唯一解。</p>
<p>下面放出我RE的wp</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210603172806739.png" alt="image-20210603172806739"></p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210603172601553.png" alt="image-20210603172601553"></p>
<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p>先跑程序：<br>Have you ever seen a total lunar eclipse? It would be a pity if you didn’t see it on May 26<br>Do you want to know the flag?(yes/no)<br>yes<br>here is the flag<br>first way : -01256AELT_aceilnprstu<br>second way : T0-LA1526Eta_lcienrpsu<br>You have known too much. Find a third way<br>dont forget Dozerctf{}<br>md5{third way}:2ab8484a34cdb3c6e4bbb4910e4f1dbf<br>就是构造二叉树，给出前序遍历中序遍历，找后序遍历的结果。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210531012101755.png" alt="image-20210531012101755"></p>
<p>Dozerctf{-2651EAL0_eicpsrnlautT}</p>
<h2 id="I-wanna-be-the-Dozer"><a href="#I-wanna-be-the-Dozer" class="headerlink" title="I wanna be the Dozer"></a>I wanna be the Dozer</h2><p>昨晚看到上题的消息就已经猜到有多简单了</p>
<p>早上起来秒了</p>
<p>gm8decompiler.exe直接反编译</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210531012353046.png" alt="image-20210531012353046"></p>
<p>双击打开工程文件，直接看背景文件</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210531012411103.png" alt="image-20210531012411103"></p>
<p>Dozerctf{i_wanna_To_be_THE_gay}</p>
<h2 id="NIM"><a href="#NIM" class="headerlink" title="NIM"></a>NIM</h2><p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210531013215822.png" alt="image-20210531013215822"></p>
<p>程序先解一串base64，然后进行des加密，动调发现密钥为DozerCTF。写脚本解密。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">s=[  <span class="number">0x4D</span>, <span class="number">0x48</span>, <span class="number">0x68</span>, <span class="number">0x43</span>, <span class="number">0x4F</span>, <span class="number">0x44</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x4F</span>, <span class="number">0x54</span>,</span><br><span class="line">  <span class="number">0x6C</span>, <span class="number">0x47</span>, <span class="number">0x4F</span>, <span class="number">0x44</span>, <span class="number">0x59</span>, <span class="number">0x34</span>, <span class="number">0x51</span>, <span class="number">0x6A</span>, <span class="number">0x59</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x4D</span>, <span class="number">0x30</span>, <span class="number">0x4E</span>, <span class="number">0x30</span>, <span class="number">0x55</span>, <span class="number">0x30</span>, <span class="number">0x4E</span>, <span class="number">0x6A</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x79</span>, <span class="number">0x4D</span>, <span class="number">0x30</span>, <span class="number">0x45</span>, <span class="number">0x79</span>, <span class="number">0x51</span>, <span class="number">0x6B</span>, <span class="number">0x51</span>, <span class="number">0x32</span>,</span><br><span class="line">  <span class="number">0x4F</span>, <span class="number">0x44</span>, <span class="number">0x41</span>, <span class="number">0x7A</span>, <span class="number">0x52</span>, <span class="number">0x45</span>, <span class="number">0x52</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x6B</span>,</span><br><span class="line">  <span class="number">0x55</span>, <span class="number">0x33</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x4D</span>, <span class="number">0x78</span>, <span class="number">0x4F</span>, <span class="number">0x44</span>, <span class="number">0x51</span>, <span class="number">0x32</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x30</span>, <span class="number">0x51</span>, <span class="number">0x34</span>, <span class="number">0x52</span>, <span class="number">0x6A</span>, <span class="number">0x55</span>, <span class="number">0x35</span>, <span class="number">0x52</span>, <span class="number">0x6A</span>,</span><br><span class="line">  <span class="number">0x55</span>, <span class="number">0x79</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x45</span>, <span class="number">0x35</span>, <span class="number">0x51</span>, <span class="number">0x54</span>, <span class="number">0x51</span>, <span class="number">0x34</span>,</span><br><span class="line">  <span class="number">0x4F</span>, <span class="number">0x44</span>, <span class="number">0x6C</span>, <span class="number">0x47</span>, <span class="number">0x4D</span>, <span class="number">0x6B</span>, <span class="number">0x45</span>, <span class="number">0x77</span>, <span class="number">0x4D</span>, <span class="number">0x54</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x30</span>, <span class="number">0x4D</span>, <span class="number">0x45</span>, <span class="number">0x49</span>, <span class="number">0x34</span>, <span class="number">0x4F</span>, <span class="number">0x54</span>, <span class="number">0x6B</span>, <span class="number">0x77</span>,</span><br><span class="line">  <span class="number">0x4F</span>, <span class="number">0x45</span>, <span class="number">0x55</span>, <span class="number">0x7A</span>, <span class="number">0x52</span>, <span class="number">0x44</span>, <span class="number">0x55</span>, <span class="number">0x35</span>, <span class="number">0x52</span>, <span class="number">0x44</span>,</span><br><span class="line">  <span class="number">0x67</span>, <span class="number">0x34</span>, <span class="number">0x52</span>, <span class="number">0x44</span>, <span class="number">0x49</span>, <span class="number">0x77</span>, <span class="number">0x4D</span>, <span class="number">0x6A</span>, <span class="number">0x4D</span>, <span class="number">0x79</span>,</span><br><span class="line">  <span class="number">0x4E</span>, <span class="number">0x54</span>, <span class="number">0x67</span>, <span class="number">0x78</span>, <span class="number">0x51</span>, <span class="number">0x6B</span>, <span class="number">0x59</span>, <span class="number">0x30</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>,</span><br><span class="line">  <span class="number">0x45</span>, <span class="number">0x7A</span>, <span class="number">0x4F</span>, <span class="number">0x54</span>, <span class="number">0x59</span>, <span class="number">0x7A</span>, <span class="number">0x4F</span>, <span class="number">0x55</span>, <span class="number">0x59</span>, <span class="number">0x78</span>,</span><br><span class="line">  <span class="number">0x4E</span>, <span class="number">0x30</span>, <span class="number">0x55</span>, <span class="number">0x34</span>, <span class="number">0x52</span>, <span class="number">0x44</span>, <span class="number">0x41</span>, <span class="number">0x77</span>, <span class="number">0x4D</span>, <span class="number">0x7A</span>,</span><br><span class="line">  <span class="number">0x45</span>, <span class="number">0x33</span>, <span class="number">0x4E</span>, <span class="number">0x6A</span>, <span class="number">0x63</span>, <span class="number">0x34</span>, <span class="number">0x52</span>, <span class="number">0x45</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x54</span>, <span class="number">0x4D</span>, <span class="number">0x30</span>, <span class="number">0x52</span>, <span class="number">0x45</span>, <span class="number">0x45</span>, <span class="number">0x34</span>, <span class="number">0x51</span>, <span class="number">0x54</span>,</span><br><span class="line">  <span class="number">0x42</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x7A</span>, <span class="number">0x45</span>, <span class="number">0x30</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x42</span>, <span class="number">0x43</span>,</span><br><span class="line">  <span class="number">0x4F</span>, <span class="number">0x44</span>, <span class="number">0x6B</span>, <span class="number">0x35</span>, <span class="number">0x4D</span>, <span class="number">0x44</span>, <span class="number">0x68</span>, <span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x31</span>, <span class="number">0x4F</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x33</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x67</span>, <span class="number">0x78</span>,</span><br><span class="line">  <span class="number">0x4F</span>, <span class="number">0x54</span>, <span class="number">0x4A</span>, <span class="number">0x44</span>, <span class="number">0x51</span>, <span class="number">0x55</span>, <span class="number">0x49</span>, <span class="number">0x34</span>, <span class="number">0x51</span>, <span class="number">0x7A</span>,</span><br><span class="line">  <span class="number">0x68</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x30</span>, <span class="number">0x4E</span>, <span class="number">0x45</span>, <span class="number">0x4F</span>, <span class="number">0x44</span>, <span class="number">0x6B</span>, <span class="number">0x7A</span>,</span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x54</span>, <span class="number">0x49</span>, <span class="number">0x7A</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x42</span>, <span class="number">0x45</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>,</span><br><span class="line">  <span class="number">0x59</span>, <span class="number">0x30</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x51</span>, <span class="number">0x30</span>, <span class="number">0x4F</span>, <span class="number">0x54</span>, <span class="number">0x64</span>, <span class="number">0x43</span>,</span><br><span class="line">  <span class="number">0x4E</span>, <span class="number">0x54</span>, <span class="number">0x67</span>, <span class="number">0x77</span>, <span class="number">0x52</span>, <span class="number">0x6B</span>, <span class="number">0x4A</span>, <span class="number">0x45</span>, <span class="number">0x51</span>, <span class="number">0x54</span>,</span><br><span class="line">  <span class="number">0x42</span>, <span class="number">0x45</span>, <span class="number">0x4D</span>, <span class="number">0x6B</span>, <span class="number">0x55</span>, <span class="number">0x31</span>, <span class="number">0x52</span>, <span class="number">0x6B</span>, <span class="number">0x56</span>, <span class="number">0x46</span>,</span><br><span class="line">  <span class="number">0x4F</span>, <span class="number">0x54</span>, <span class="number">0x45</span>, <span class="number">0x7A</span>, <span class="number">0x51</span>, <span class="number">0x6A</span>, <span class="number">0x6C</span>, <span class="number">0x43</span>, <span class="number">0x4F</span>, <span class="number">0x54</span>,</span><br><span class="line">  <span class="number">0x67</span>, <span class="number">0x32</span>, <span class="number">0x4E</span>, <span class="number">0x6A</span>, <span class="number">0x64</span>, <span class="number">0x47</span>, <span class="number">0x51</span>, <span class="number">0x55</span>, <span class="number">0x5A</span>, <span class="number">0x45</span>,</span><br><span class="line">  <span class="number">0x4F</span>, <span class="number">0x55</span>, <span class="number">0x45</span>, <span class="number">0x32</span>, <span class="number">0x51</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x79</span>, <span class="number">0x4F</span>, <span class="number">0x44</span>,</span><br><span class="line">  <span class="number">0x59</span>, <span class="number">0x78</span>, <span class="number">0x51</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x7A</span>, <span class="number">0x4E</span>, <span class="number">0x54</span>, <span class="number">0x64</span>, <span class="number">0x42</span>,</span><br><span class="line">  <span class="number">0x52</span>, <span class="number">0x6A</span>, <span class="number">0x59</span>, <span class="number">0x33</span>, <span class="number">0x4E</span>, <span class="number">0x55</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x4D</span>, <span class="number">0x6A</span>,</span><br><span class="line">  <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x4D</span>, <span class="number">0x44</span>, <span class="number">0x63</span>, <span class="number">0x32</span>, <span class="number">0x51</span>, <span class="number">0x6A</span>, <span class="number">0x6C</span>, <span class="number">0x43</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x33</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x51</span>, <span class="number">0x32</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>,</span><br><span class="line">  <span class="number">0x49</span>, <span class="number">0x7A</span>, <span class="number">0x51</span>, <span class="number">0x54</span>, <span class="number">0x4A</span>, <span class="number">0x43</span>, <span class="number">0x52</span>, <span class="number">0x44</span>, <span class="number">0x59</span>, <span class="number">0x34</span>,</span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x44</span>, <span class="number">0x4E</span>, <span class="number">0x45</span>, <span class="number">0x51</span>, <span class="number">0x54</span>, <span class="number">0x5A</span>, <span class="number">0x45</span>, <span class="number">0x51</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x77</span>, <span class="number">0x4E</span>, <span class="number">0x7A</span>, <span class="number">0x4A</span>, <span class="number">0x43</span>, <span class="number">0x4E</span>, <span class="number">0x30</span>, <span class="number">0x4D</span>, <span class="number">0x31</span>,</span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x45</span>, <span class="number">0x56</span>, <span class="number">0x42</span>, <span class="number">0x51</span>, <span class="number">0x54</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x44</span>,</span><br><span class="line">  <span class="number">0x59</span>, <span class="number">0x35</span>, <span class="number">0x52</span>, <span class="number">0x44</span>, <span class="number">0x59</span>, <span class="number">0x35</span>, <span class="number">0x4D</span>, <span class="number">0x54</span>, <span class="number">0x49</span>, <span class="number">0x31</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x7A</span>, <span class="number">0x49</span>, <span class="number">0x33</span>, <span class="number">0x4E</span>, <span class="number">0x45</span>, <span class="number">0x4A</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x55</span>,</span><br><span class="line">  <span class="number">0x49</span>, <span class="number">0x31</span>, <span class="number">0x52</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0x44</span>, <span class="number">0x51</span>, <span class="number">0x30</span>, <span class="number">0x4A</span>, <span class="number">0x46</span>,</span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x30</span>, <span class="number">0x51</span>, <span class="number">0x7A</span>, <span class="number">0x52</span>, <span class="number">0x45</span>, <span class="number">0x46</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0x55</span>, <span class="number">0x30</span>, <span class="number">0x4E</span>, <span class="number">0x6A</span>, <span class="number">0x51</span>, <span class="number">0x79</span>, <span class="number">0x4D</span>, <span class="number">0x30</span>, <span class="number">0x45</span>, <span class="number">0x79</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x6B</span>, <span class="number">0x51</span>, <span class="number">0x32</span>, <span class="number">0x4F</span>, <span class="number">0x44</span>, <span class="number">0x41</span>, <span class="number">0x7A</span>, <span class="number">0x52</span>, <span class="number">0x44</span>,</span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x51</span>, <span class="number">0x6B</span>, <span class="number">0x4E</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x30</span>, <span class="number">0x56</span>, <span class="number">0x46</span>,</span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x6A</span>, <span class="number">0x55</span>, <span class="number">0x34</span>, <span class="number">0x4F</span>, <span class="number">0x54</span>, <span class="number">0x67</span>, <span class="number">0x31</span>, <span class="number">0x52</span>, <span class="number">0x6A</span>,</span><br><span class="line">  <span class="number">0x59</span>, <span class="number">0x33</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x51</span>, <span class="number">0x32</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x49</span>, <span class="number">0x7A</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x54</span>, <span class="number">0x4A</span>, <span class="number">0x43</span>, <span class="number">0x52</span>, <span class="number">0x44</span>, <span class="number">0x59</span>, <span class="number">0x34</span>, <span class="number">0x4D</span>, <span class="number">0x44</span>,</span><br><span class="line">  <span class="number">0x4E</span>, <span class="number">0x45</span>, <span class="number">0x51</span>, <span class="number">0x7A</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x51</span>, <span class="number">0x6A</span>, <span class="number">0x55</span>, <span class="number">0x79</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x6B</span>, <span class="number">0x51</span>, <span class="number">0x30</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x4A</span>, <span class="number">0x47</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>,</span><br><span class="line">  <span class="number">0x67</span>, <span class="number">0x30</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x44</span>, <span class="number">0x59</span>, <span class="number">0x35</span>,</span><br><span class="line">  <span class="number">0x52</span>, <span class="number">0x44</span>, <span class="number">0x59</span>, <span class="number">0x35</span>, <span class="number">0x4D</span>, <span class="number">0x54</span>, <span class="number">0x49</span>, <span class="number">0x31</span>, <span class="number">0x51</span>, <span class="number">0x7A</span>,</span><br><span class="line">  <span class="number">0x49</span>, <span class="number">0x33</span>, <span class="number">0x4E</span>, <span class="number">0x45</span>, <span class="number">0x49</span>, <span class="number">0x33</span>, <span class="number">0x4E</span>, <span class="number">0x54</span>, <span class="number">0x6B</span>, <span class="number">0x32</span>,</span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x78</span>, <span class="number">0x52</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x34</span>, <span class="number">0x51</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0x59</span>, <span class="number">0x31</span>, <span class="number">0x52</span>, <span class="number">0x6A</span>, <span class="number">0x4D</span>, <span class="number">0x7A</span>, <span class="number">0x4E</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x79</span>,</span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x30</span>, <span class="number">0x4D</span>, <span class="number">0x32</span>, <span class="number">0x4F</span>, <span class="number">0x45</span>, <span class="number">0x51</span>, <span class="number">0x32</span>, <span class="number">0x4E</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0x56</span>, <span class="number">0x45</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x4D</span>, <span class="number">0x54</span>, <span class="number">0x59</span>, <span class="number">0x33</span>,</span><br><span class="line">  <span class="number">0x4F</span>, <span class="number">0x45</span>, <span class="number">0x52</span>, <span class="number">0x44</span>, <span class="number">0x51</span>, <span class="number">0x30</span>, <span class="number">0x45</span>, <span class="number">0x7A</span>, <span class="number">0x4E</span>, <span class="number">0x45</span>,</span><br><span class="line">  <span class="number">0x52</span>, <span class="number">0x42</span>, <span class="number">0x4F</span>, <span class="number">0x45</span>, <span class="number">0x45</span>, <span class="number">0x77</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>,</span><br><span class="line">  <span class="number">0x4E</span>, <span class="number">0x7A</span>, <span class="number">0x5A</span>, <span class="number">0x44</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0x42</span>, <span class="number">0x4E</span>, <span class="number">0x54</span>,</span><br><span class="line">  <span class="number">0x45</span>, <span class="number">0x35</span>, <span class="number">0x4D</span>, <span class="number">0x6B</span>, <span class="number">0x51</span>, <span class="number">0x77</span>, <span class="number">0x52</span>, <span class="number">0x45</span>, <span class="number">0x46</span>, <span class="number">0x46</span>,</span><br><span class="line">  <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0x44</span>, <span class="number">0x4F</span>, <span class="number">0x55</span>, <span class="number">0x4E</span>, <span class="number">0x42</span>, <span class="number">0x4E</span>, <span class="number">0x54</span>,</span><br><span class="line">  <span class="number">0x6B</span>, <span class="number">0x77</span>, <span class="number">0x4F</span>, <span class="number">0x55</span>, <span class="number">0x52</span>, <span class="number">0x42</span>, <span class="number">0x4E</span>, <span class="number">0x44</span>, <span class="number">0x49</span>, <span class="number">0x31</span>,</span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x7A</span>, <span class="number">0x63</span>, <span class="number">0x77</span>, <span class="number">0x4E</span>, <span class="number">0x54</span>, <span class="number">0x59</span>, <span class="number">0x78</span>, <span class="number">0x4D</span>, <span class="number">0x54</span>,</span><br><span class="line">  <span class="number">0x42</span>, <span class="number">0x44</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x46</span>, <span class="number">0x44</span>, <span class="number">0x52</span>, <span class="number">0x6A</span>, <span class="number">0x59</span>, <span class="number">0x33</span>,</span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x55</span>, <span class="number">0x51</span>, <span class="number">0x30</span>, <span class="number">0x4E</span>, <span class="number">0x30</span>, <span class="number">0x4D</span>, <span class="number">0x35</span>, <span class="number">0x51</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0x45</span>, <span class="number">0x31</span>, <span class="number">0x4F</span>, <span class="number">0x54</span>, <span class="number">0x41</span>, <span class="number">0x35</span>, <span class="number">0x52</span>, <span class="number">0x45</span>, <span class="number">0x45</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x6A</span>, <span class="number">0x55</span>, <span class="number">0x7A</span>, <span class="number">0x4F</span>, <span class="number">0x44</span>, <span class="number">0x51</span>, <span class="number">0x33</span>, <span class="number">0x4D</span>, <span class="number">0x6A</span>,</span><br><span class="line">  <span class="number">0x63</span>, <span class="number">0x31</span>, <span class="number">0x4D</span>, <span class="number">0x30</span>, <span class="number">0x59</span>, <span class="number">0x78</span>, <span class="number">0x52</span>, <span class="number">0x55</span>, <span class="number">0x45</span>, <span class="number">0x33</span>,</span><br><span class="line">  <span class="number">0x4F</span>, <span class="number">0x55</span>, <span class="number">0x46</span>, <span class="number">0x44</span>, <span class="number">0x4F</span>, <span class="number">0x41</span>, <span class="number">0x3D</span>, <span class="number">0x3D</span>]</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">key=<span class="string">b&#x27;DozerCTF&#x27;</span></span><br><span class="line"></span><br><span class="line">enc=<span class="number">0xB81D99F868B641C47E46423A2BD6803DDE2E71C1846CD8F59F52419A4889F2A01440B89908E3D59D88D20232581BF41A39639F17E8D00317678DCCA34DA8A0E31440B89908E3D59D7E8192CAB8C8F7CD89312340D1F444497B580FBDA0D2E5FEE913B9B98667FAFD9A6A52861A5357AF675AD25F076B9BA57E46423A2BD6803DA6DCD072B7C50EAA4B069D69125C274BB1B5D7CCBE3D3DAF7E46423A2BD6803D37BCB3EE258985F67E46423A2BD6803DC37B52BD4E2F484E4B069D69125C274B75961E1D38CF5F335E23C68D67ED43C1678DCCA34DA8A0E3F76C47A5192D0DAE47C9CA5909DA42537056110CE1CF671D47C9CA5909DA42538472753F1EA79AC8</span></span><br><span class="line"></span><br><span class="line">de=DES.new(key,DES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">print(de.decrypt(long_to_bytes(enc)))</span><br></pre></td></tr></table></figure>
<p>得到一个奇怪的字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;$*000000*000*0000*000000*00***000***0000*00*000000*00000****00000***0000*00000**0*0*0*00*00000*0000****0*00****0000*0*00*000*0000***0*00*0***0000*00*****000*0000*00*000*000*0000*0***00*0***0000*0*0000***0**00****000000000*00000*000000000**0000*0000000000*$&#39;</span><br></pre></td></tr></table></figure>
<p>然后看着代码，发现在最后出现</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210531013437146.png" alt="image-20210531013437146"></p>
<p>这很迷宫，恰逢早上AK了dasctf的逆向，其中也有一道迷宫。然后就找长宽。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># $*000000*000*000</span><br><span class="line"># 0*000000*00***00</span><br><span class="line"># 0***0000*00*0000</span><br><span class="line"># 00*00000****0000</span><br><span class="line"># 0***0000*00000**</span><br><span class="line"># 0*0*0*00*00000*0</span><br><span class="line"># 000****0*00****0</span><br><span class="line"># 000*0*00*000*000</span><br><span class="line"># 0***0*00*0***000</span><br><span class="line"># 0*00*****000*000</span><br><span class="line"># 0*00*000*000*000</span><br><span class="line"># 0*0***00*0***000</span><br><span class="line"># 0*0*0000***0**00</span><br><span class="line"># ****000000000*00</span><br><span class="line"># 000*000000000**0</span><br><span class="line"># 000*0000000000*$</span><br></pre></td></tr></table></figure>
<p>得到如图的迷宫，从左上到右下。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210531022502062.png" alt="image-20210531022502062"></p>
<p>走的时候发现有两条路，一条比较短，一天比较长，然后选了短的，发现刚好32位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dssdssdssddsssdddsssddwddsdssdsd</span><br></pre></td></tr></table></figure>
<p>然后进入程序，ida附加，下断。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210531013740244.png" alt="image-20210531013740244"></p>
<p>动调发现，v60是个定值，v63是我们输入的值，v65是最终要比较的值。且为异或。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210531013812060.png" alt="image-20210531013812060"></p>
<p>故脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">dd=[ <span class="number">0x27</span>, <span class="number">0x5C</span>, <span class="number">0x4F</span>, <span class="number">0x01</span>, <span class="number">0x45</span>, <span class="number">0x07</span>, <span class="number">0x15</span>, <span class="number">0x5F</span>, <span class="number">0x42</span>, <span class="number">0x5C</span>,</span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x1C</span>, <span class="number">0x07</span>, <span class="number">0x57</span>, <span class="number">0x6F</span>, <span class="number">0x1D</span>, <span class="number">0x5F</span>, <span class="number">0x43</span>, <span class="number">0x0A</span>, <span class="number">0x5E</span>,</span><br><span class="line">  <span class="number">0x5B</span>, <span class="number">0x14</span>, <span class="number">0x3E</span>, <span class="number">0x11</span>, <span class="number">0x5F</span>, <span class="number">0x01</span>, <span class="number">0x3E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x57</span>,</span><br><span class="line">  <span class="number">0x12</span>, <span class="number">0x1F</span>]</span><br><span class="line">ff=[<span class="number">0x63</span>, <span class="number">0x33</span>, <span class="number">0x35</span>, <span class="number">0x64</span>, <span class="number">0x37</span>, <span class="number">0x64</span>, <span class="number">0x61</span>, <span class="number">0x39</span>, <span class="number">0x39</span>, <span class="number">0x31</span>,</span><br><span class="line">  <span class="number">0x30</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0x64</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0x61</span>, <span class="number">0x30</span>,</span><br><span class="line">  <span class="number">0x34</span>, <span class="number">0x63</span>, <span class="number">0x61</span>, <span class="number">0x65</span>, <span class="number">0x37</span>, <span class="number">0x64</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x36</span>,</span><br><span class="line">  <span class="number">0x66</span>, <span class="number">0x62</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dd)):</span><br><span class="line">  print(<span class="built_in">chr</span>(dd[i]^ff[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>Dozerctf{maybe_youknow_the_beat}</p>
<h2 id="Classical-RE"><a href="#Classical-RE" class="headerlink" title="Classical RE"></a>Classical RE</h2><p>安卓逆向，Ollvm混淆</p>
<p>加密源码在so文件里面。再到对应函数，ollvm的。。头皮发麻，本来要放弃的，不过看代码长度混淆后才300行有点短。直接逆了。然后动调这个so文件，猜+动调。</p>
<p>一直动调跟踪输入流。</p>
<p>发现加密很简单，就是</p>
<p>用‘dozer’对输入流进行循环异或，然后再将密文切割开来前面一半异或后面。</p>
<p>倒过来求，然后拼接在一起就行了，，hh侥幸拿了一血。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ds=[ <span class="number">0x18</span>, <span class="number">0x3A</span>, <span class="number">0x18</span>, <span class="number">0x1E</span>, <span class="number">0x27</span>, <span class="number">0x1A</span>, <span class="number">0x0E</span>, <span class="number">0x39</span>,<span class="number">0x15</span>,<span class="number">0x1D</span>,</span><br><span class="line">  <span class="number">0x3B</span>, <span class="number">0x06</span>, <span class="number">0x09</span>, <span class="number">0x3A</span>, <span class="number">0x17</span>, <span class="number">0x05</span>, <span class="number">0x1C</span>, <span class="number">0x03</span>]</span><br><span class="line">do=<span class="string">&#x27;dozer&#x27;</span></span><br><span class="line">print(<span class="built_in">bytearray</span>(ds))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ds)):</span><br><span class="line">  print(<span class="built_in">chr</span>(<span class="built_in">ord</span>(do[i%<span class="built_in">len</span>(do)])^ds[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">dd=<span class="string">&#x27;o_is_easy&#x27;</span></span><br><span class="line">ss=<span class="string">&#x27;|Ub&#123;U~aCp&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in range(len(ds)):</span></span><br><span class="line"><span class="comment">#   print(chr(ds[i]^dss[i]^ord(do[i%len(do)])),end=&#x27;&#x27;)</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">po=[<span class="number">0x18</span>, <span class="number">0x3A</span>, <span class="number">0x18</span>, <span class="number">0x1E</span>, <span class="number">0x27</span>, <span class="number">0x1A</span>, <span class="number">0x0E</span>, <span class="number">0x39</span>,<span class="number">0x15</span>]</span><br><span class="line">po1=[<span class="number">0x1D</span>,</span><br><span class="line">  <span class="number">0x3B</span>, <span class="number">0x06</span>, <span class="number">0x09</span>, <span class="number">0x3A</span>, <span class="number">0x17</span>, <span class="number">0x05</span>, <span class="number">0x1C</span>, <span class="number">0x03</span>]</span><br><span class="line"><span class="comment">#android_o_is_easy</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(po)):</span><br><span class="line">  print(<span class="built_in">chr</span>(po[i]^po1[i]^<span class="built_in">ord</span>(do[i%<span class="number">5</span>])),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#android_so_is_easy </span></span><br><span class="line"><span class="comment">#Dozerctf&#123;android_so_is_easy &#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="这题好熟悉啊"><a href="#这题好熟悉啊" class="headerlink" title="这题好熟悉啊"></a>这题好熟悉啊</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> malduck <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&quot;./dump&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()[<span class="number">0x5060</span>:<span class="number">0x5b6e0</span>]</span><br><span class="line"></span><br><span class="line">enc_flag = data[:<span class="number">0x80</span>]</span><br><span class="line"></span><br><span class="line">candidate = <span class="string">b&quot;&quot;</span></span><br><span class="line">key_iv = []</span><br><span class="line">x = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> x &lt; <span class="built_in">len</span>(data) - <span class="number">0x10</span>:</span><br><span class="line">    candidate = data[x:x+<span class="number">0x10</span>]</span><br><span class="line">    <span class="keyword">if</span> data.count(candidate) &gt; <span class="number">1</span>:</span><br><span class="line">        key_iv.append(candidate)</span><br><span class="line">    x += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#print(aes.cbc.decrypt(key_iv[0], key_iv[1], enc_flag))</span></span><br><span class="line">print(aes.cbc.decrypt(key_iv[<span class="number">1</span>], key_iv[<span class="number">0</span>], enc_flag))</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;ICw\x8eq\x9a\x94MT \xd3u\x11u\xdf\x86ctf ,flag is Dozerctf&#123;maybe_you_know_this_challenge&#125;\n\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc&#x27;</span></span><br><span class="line"><span class="comment">#Dozerctf&#123;maybe_you_know_this_challenge&#125;</span></span><br></pre></td></tr></table></figure></div></article></div></main><footer><div class="paginator"><a href="/2021/06/01/%E7%AC%AC%E4%BA%8C%E5%B1%8A-newsctf/" class="prev">PREV</a><a href="/2021/05/31/DASCTF-5%E6%9C%88/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2021 <a href="http://example.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>