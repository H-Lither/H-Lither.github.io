<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> DASCTF 6月 · H-Lither</title><meta name="description" content="DASCTF 6月 - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://example.com/atom.xml" title="H-Lither"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="H-Lither" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">DASCTF 6月</h1><div class="post-info">Jun 26, 2021</div><div class="post-content"><p>-rank：5</p>
<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="Crash-F-working-1u1u"><a href="#Crash-F-working-1u1u" class="headerlink" title="Crash | F | working: 1u1u"></a>Crash | F | working: 1u1u</h3><p>IDA打开，发现是GO的，插件恢复不了，上了7.6免费版。</p>
<p>逻辑很清晰。</p>
<p>将flag拆成4部分进行加密。</p>
<p>3DES-SHA256,SHA512,MD5</p>
<p>前面一个直接解密，</p>
<p>密钥给了。。</p>
<p><img src="https://kjd3xtsq9r.feishu.cn/space/api/box/stream/download/asynccode/?code=ZTJhMGNmNDlhY2ZiN2VmOWY2ZDllMTI2NjE2YWNjZjBfcktlZ0ZGd3ZGdTB5NDZQS0xHczlDTm15SVREWTQzbmVfVG9rZW46Ym94Y25NeGEwbkxkdjJ6RmQzVWZ5VmpBWG9kXzE2MjY4ODI3MzQ6MTYyNjg4NjMzNF9WNA" alt="img"></p>
<p>直接解</p>
<p>后面三个爆破就行。。。。。。</p>
<p>四个字符的爆破。</p>
<p><img src="https://kjd3xtsq9r.feishu.cn/space/api/box/stream/download/asynccode/?code=OTE1OGQwNTYzNmUxNzUyODE5Njc2OWMxODk1Mjc0ZDZfZFhxMmFLbnk2aUJkT0xFVlRRT0F5aXRybjdSb2tubmVfVG9rZW46Ym94Y25PU01lWjlZV2xzSUlvdmRhZFJpSmpVXzE2MjY4ODI3MzQ6MTYyNjg4NjMzNF9WNA" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Cipher import DES3</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">key&#x3D;b&#39;WelcomeToTheGKCTF2021XXX&#39;</span><br><span class="line">iv&#x3D;b&#39;1Ssecret&#39;</span><br><span class="line">enc&#x3D;&#39;o&#x2F;aWPjNNxMPZDnJlNp0zK5+NLPC4Tv6kqdJqjkL0XkA&#x3D;&#39;</span><br><span class="line">de&#x3D;DES3.new(key,DES3.MODE_CBC,iv)</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">m1&#x3D;de.decrypt(base64.b64decode(enc))</span><br><span class="line">#87f645e9-b628-412f-9d7a-</span><br><span class="line">import hashlib</span><br><span class="line">m2&#x3D;&#39;&#39;</span><br><span class="line">key&#x3D;&#39;0123456789abcdef&#39;</span><br><span class="line">for a1 in key:</span><br><span class="line">    for a2 in key:</span><br><span class="line">        for a3 in key:</span><br><span class="line">            for a4 in key:</span><br><span class="line">                flag&#x3D;a1+a2+a3+a4</span><br><span class="line">                text&#x3D;hashlib.sha256(flag.encode()).hexdigest()</span><br><span class="line">                t&#x3D;&#39;6e2b55c78937d63490b4b26ab3ac3cb54df4c5ca7d60012c13d2d1234a732b74&#39;</span><br><span class="line"></span><br><span class="line">                if text &#x3D;&#x3D;t:</span><br><span class="line">                    m2&#x3D;flag</span><br><span class="line">m3&#x3D;&#39;&#39;</span><br><span class="line">key&#x3D;&#39;0123456789abcdef&#39;</span><br><span class="line">for a1 in key:</span><br><span class="line">    for a2 in key:</span><br><span class="line">        for a3 in key:</span><br><span class="line">            for a4 in key:</span><br><span class="line">                flag&#x3D;a1+a2+a3+a4</span><br><span class="line">                text&#x3D;hashlib.sha512(flag.encode()).hexdigest()</span><br><span class="line">                t&#x3D;&#39;6500fe72abcab63d87f213d2218b0ee086a1828188439ca485a1a40968fd272865d5ca4d5ef5a651270a52ff952d955c9b757caae1ecce804582ae78f87fa3c9&#39;</span><br><span class="line"></span><br><span class="line">                if text &#x3D;&#x3D;t:</span><br><span class="line">                    m3&#x3D;flag</span><br><span class="line">key&#x3D;&#39;0123456789abcdef&#39;</span><br><span class="line">m4&#x3D;&#39;&#39;</span><br><span class="line">for a1 in key:</span><br><span class="line">    for a2 in key:</span><br><span class="line">        for a3 in key:</span><br><span class="line">            for a4 in key:</span><br><span class="line">                flag&#x3D;a1+a2+a3+a4</span><br><span class="line">                text&#x3D;hashlib.md5(flag.encode()).hexdigest()</span><br><span class="line">                t&#x3D;&#39;ff6e2fd78aca4736037258f0ede4ecf0&#39;</span><br><span class="line">                if text &#x3D;&#x3D;t:</span><br><span class="line">                    m4&#x3D;flag</span><br><span class="line">print(&#39;GKCTF&#123;&#39;+str(m1)[:24]+m2+m3+m4+&#39;&#125;&#39;)</span><br><span class="line">#GKCTF&#123;87f645e9-b628-412f-9d7e402f20af940&#125;</span><br></pre></td></tr></table></figure>




<h3 id="QQQQT-F-working-1u1u"><a href="#QQQQT-F-working-1u1u" class="headerlink" title="QQQQT | F | working: 1u1u"></a>QQQQT | F | working: 1u1u</h3><p>Enigma Virtual Box 打包的，</p>
<p>解包释放资源就可以找到源文件，</p>
<p>ida打开。找到特殊字符串。</p>
<p>动调的过程发现为base58 </p>
<p>编码为：56fkoP8KhwCf3v7CEz</p>
<p><img src="https://kjd3xtsq9r.feishu.cn/space/api/box/stream/download/asynccode/?code=MjE5ZDMyMWYwMTE1MGViYTMzOGE0MTRjODY0MTFlMzVfRktDenkxUTlINktoTVZHMkhvY2k3WkRFZVVtd0RGWkpfVG9rZW46Ym94Y25YWm5xZFBrR2habXlDM3RvclFGWUNnXzE2MjY4ODI3MzQ6MTYyNjg4NjMzNF9WNA" alt="img"></p>
<p>解码即可</p>
<p>flag{12t4tww3r5e77}   #不是GKCTF{}</p>
<h3 id="app-debug-F-working-1u1u"><a href="#app-debug-F-working-1u1u" class="headerlink" title="app-debug| F | working: 1u1u"></a>app-debug| F | working: 1u1u</h3><p>逻辑在so文件，是个a8，64位的。</p>
<p>发现里面有TEA，key不知道，直接动调。，密文也有。常规tea解密即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;Windows.h&gt;</span><br><span class="line"></span><br><span class="line">void Encrypt(long* EntryData, long* Key)</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F;分别加密数组中的前四个字节与后4个字节,4个字节为一组每次加密两组</span><br><span class="line">    unsigned long x &#x3D; EntryData[0];</span><br><span class="line">    unsigned long y &#x3D; EntryData[1];</span><br><span class="line"></span><br><span class="line">    unsigned long sum &#x3D; 0;</span><br><span class="line">    unsigned long delta &#x3D; 0x458BCD42;</span><br><span class="line">    &#x2F;&#x2F;总共加密32轮</span><br><span class="line">    for (int i &#x3D; 0; i &lt; 32; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        sum +&#x3D; delta;</span><br><span class="line">        x +&#x3D; ((y &lt;&lt; 4) + Key[0]) ^ (y + sum) ^ ((y &gt;&gt; 5) + Key[1]);</span><br><span class="line">        y +&#x3D; ((x &lt;&lt; 4) + Key[2]) ^ (x + sum) ^ ((x &gt;&gt; 5) + Key[3]);</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F;最后加密的结果重新写入到数组中</span><br><span class="line">    EntryData[0] &#x3D; x;</span><br><span class="line">    EntryData[1] &#x3D; y;</span><br><span class="line">    printf(&quot;%x &quot;, x);</span><br><span class="line">        printf(&quot;%x &quot;, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Decrypt(long* EntryData, long* Key)</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F;分别加密数组中的前四个字节与后4个字节,4个字节为一组每次加密两组</span><br><span class="line">    unsigned long x &#x3D; EntryData[0];</span><br><span class="line">    unsigned long y &#x3D; EntryData[1];</span><br><span class="line"></span><br><span class="line">    unsigned long sum &#x3D; 0;</span><br><span class="line">    unsigned long delta &#x3D; 0x458BCD42;</span><br><span class="line">    sum &#x3D; delta &lt;&lt; 5;   &#x2F;&#x2F;注意这里,sum &#x3D; 32轮之后的黄金分割值. 因为我们要反序解密.</span><br><span class="line">    &#x2F;&#x2F;总共加密32轮 那么反序也解密32轮</span><br><span class="line">    for (int i &#x3D; 0; i &lt; 32; i++)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 先将y解开 然后参与运算在解x</span><br><span class="line">        y -&#x3D; ((x &lt;&lt; 4) + Key[2]) ^ (x + sum) ^ ((x &gt;&gt; 5) + Key[3]);</span><br><span class="line">        x -&#x3D; ((y &lt;&lt; 4) + Key[0]) ^ (y + sum) ^ ((y &gt;&gt; 5) + Key[1]);</span><br><span class="line">        sum -&#x3D; delta;</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F;最后加密的结果重新写入到数组中</span><br><span class="line">    EntryData[0] &#x3D; x;</span><br><span class="line">    EntryData[1] &#x3D; y;</span><br><span class="line">    printf(&quot;%x &quot;, x);</span><br><span class="line">    printf(&quot;%x &quot;, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    long Data[2] &#x3D; &#123; 0x54634b47,0x306746 &#125;;</span><br><span class="line">    printf(&quot;待加密的数值 &#x3D; %x\r\n&quot;, (char*)Data);</span><br><span class="line"></span><br><span class="line">    long key[4] &#x3D; &#123; 9,7,8,6 &#125;;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;Encrypt每次只是加密4字节数组中的两组(也就是每次加密8个字节) 如果你数据多.可以来个for循环来循环加密,但是Entrypt内部还有32次循环,所以速度上还是会有点影响.</span><br><span class="line">    Encrypt(Data, key);</span><br><span class="line">    &#x2F;&#x2F;printf(&quot;加密后的数值 &#x3D; %x\r\n&quot;, (char*)Data);</span><br><span class="line">    &#x2F;&#x2F;Decrypt(Data, key);</span><br><span class="line">    printf(&quot;解密后的数值 &#x3D; %s\r\n&quot;, (char*)Data);</span><br><span class="line">    system(&quot;pause&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;GKcTFg0</span><br><span class="line">&#x2F;&#x2F;flag&#123;md5(GKcTFg0)&#125;</span><br></pre></td></tr></table></figure></div></article></div></main><footer><div class="paginator"><a href="/2021/07/15/hsctf/" class="prev">PREV</a><a href="/2021/06/01/%E7%AC%AC%E4%BA%8C%E5%B1%8A-newsctf/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2021 <a href="http://example.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>