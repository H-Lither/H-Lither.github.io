<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 蓝帽杯半决赛 · H-Lither</title><meta name="description" content="蓝帽杯半决赛 - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://example.com/atom.xml" title="H-Lither"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="H-Lither" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">蓝帽杯半决赛</h1><div class="post-info">Jun 3, 2021</div><div class="post-content"><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="src-leak"><a href="#src-leak" class="headerlink" title="src_leak"></a>src_leak</h2><p>func1 对于输入求平方根然后向下取整</p>
<p>func2 统计给定无符号数二进制表示中1的个数</p>
<p>func3 模2</p>
<p>func4 判断是不是素数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> (x % <span class="number">2</span>) + func2(x // <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func3</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> x % <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span>(<span class="params">N, L, R</span>):</span></span><br><span class="line">    <span class="keyword">if</span> L == R:</span><br><span class="line">        <span class="keyword">return</span> L</span><br><span class="line">    mid = (L + R + <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> N &lt; mid * mid:</span><br><span class="line">        <span class="keyword">return</span> func1(N, L, mid - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> func1(N, mid, R)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_func1</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> func1(x, <span class="number">1</span>, x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    x1_flag = <span class="number">0</span></span><br><span class="line">    x2_flag = <span class="number">0</span></span><br><span class="line">    x3_flag = <span class="number">0</span></span><br><span class="line">    x4_flag = <span class="number">0</span></span><br><span class="line">    x5_flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>, <span class="number">54435556</span>):</span><br><span class="line">        <span class="comment">#print(i)</span></span><br><span class="line">        <span class="keyword">if</span> func3(func2(i)) != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> _func1(i) == <span class="number">963</span> <span class="keyword">and</span> <span class="keyword">not</span> x1_flag:</span><br><span class="line">            print(<span class="string">&quot;x1:&quot;</span>, i)</span><br><span class="line">            x1_flag = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> _func1(i) == <span class="number">4396</span> <span class="keyword">and</span> <span class="keyword">not</span> x2_flag:</span><br><span class="line">            print(<span class="string">&quot;x2:&quot;</span>, i)</span><br><span class="line">            x2_flag = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> _func1(i) == <span class="number">6666</span> <span class="keyword">and</span> <span class="keyword">not</span> x3_flag:</span><br><span class="line">            print(<span class="string">&quot;x3:&quot;</span>, i)</span><br><span class="line">            x3_flag = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> _func1(i) == <span class="number">1999</span> <span class="keyword">and</span> <span class="keyword">not</span> x4_flag:</span><br><span class="line">            print(<span class="string">&quot;x4:&quot;</span>, i)</span><br><span class="line">            x4_flag = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> _func1(i) == <span class="number">3141</span> <span class="keyword">and</span> <span class="keyword">not</span> x5_flag:</span><br><span class="line">            print(<span class="string">&quot;x5:&quot;</span>, i)</span><br><span class="line">            x5_flag = <span class="number">1</span></span><br><span class="line"><span class="comment">#x1: 927369</span></span><br><span class="line"><span class="comment">#x4: 3996001</span></span><br><span class="line"><span class="comment">#x5: 9865881</span></span><br><span class="line"><span class="comment">#x2: 19324816</span></span><br><span class="line"><span class="comment">#x3: 44435556</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>x6为1~10000中质数的个数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">x6=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10000</span>+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> gmpy2.is_prime(x):</span><br><span class="line">      x6+=<span class="number">1</span></span><br><span class="line">print(x6)</span><br><span class="line"><span class="comment">#x6=1229</span></span><br></pre></td></tr></table></figure>
<p>合并出来就是</p>
<p> <code>flag&#123;927369-19324816-44435556-3996001-9865881-1229&#125;</code></p>
<h2 id="py交易"><a href="#py交易" class="headerlink" title="py交易"></a>py交易</h2><p><a target="_blank" rel="noopener" href="https://blog.fxti.xyz/2019/08/30/Python-Bytecode-CFF-2/#more">原题</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">13433</span>, <span class="number">4747</span>, <span class="number">17752</span>, <span class="number">33060</span>, <span class="number">31051</span>, <span class="number">48809</span>, <span class="number">29988</span>, <span class="number">6421</span>, <span class="number">20021</span>, <span class="number">38888</span>, <span class="number">24844</span>, <span class="number">20706</span>, <span class="number">11713</span>, <span class="number">34938</span>, <span class="number">12865</span>, <span class="number">6085</span>, <span class="number">37391</span>,</span><br><span class="line">     <span class="number">32840</span>, <span class="number">31964</span>, <span class="number">27194</span>, <span class="number">8701</span>, <span class="number">48142</span>, <span class="number">27066</span>, <span class="number">28626</span>, <span class="number">37431</span>, <span class="number">39142</span>, <span class="number">46795</span>, <span class="number">21771</span>, <span class="number">44280</span>, <span class="number">40628</span>, <span class="number">35013</span>, <span class="number">18583</span>, <span class="number">5418</span>, <span class="number">4347</span>,</span><br><span class="line">     <span class="number">43929</span>, <span class="number">9934</span>, <span class="number">46892</span>, <span class="number">19868</span>]</span><br><span class="line">b = [<span class="number">13711</span>, <span class="number">7074</span>, <span class="number">79833</span>, <span class="number">42654</span>, <span class="number">23241</span>, <span class="number">41412</span>, <span class="number">61795</span>, <span class="number">6373</span>, <span class="number">19304</span>, <span class="number">1363</span>, <span class="number">1682</span>, <span class="number">66279</span>, <span class="number">76134</span>, <span class="number">60748</span>, <span class="number">10355</span>, <span class="number">63484</span>, <span class="number">30491</span>,</span><br><span class="line">     <span class="number">34005</span>, <span class="number">51393</span>, <span class="number">38029</span>, <span class="number">7241</span>, <span class="number">4998</span>, <span class="number">18562</span>, <span class="number">16935</span>, <span class="number">66677</span>, <span class="number">51321</span>, <span class="number">13771</span>, <span class="number">49108</span>, <span class="number">52166</span>, <span class="number">8851</span>, <span class="number">16900</span>, <span class="number">31682</span>, <span class="number">16684</span>, <span class="number">12046</span>,</span><br><span class="line">     <span class="number">16764</span>, <span class="number">64315</span>, <span class="number">76742</span>, <span class="number">14022</span>]</span><br><span class="line">c = [<span class="number">832832835</span>, -<span class="number">924053193</span>, -<span class="number">307134635</span>, -<span class="number">527578092</span>, <span class="number">998625960</span>, -<span class="number">715102211</span>, <span class="number">3572182</span>, -<span class="number">963194083</span>, -<span class="number">475718185</span>, -<span class="number">361574731</span>,</span><br><span class="line">     -<span class="number">678171563</span>, <span class="number">107566155</span>, <span class="number">608670527</span>, <span class="number">254218946</span>, -<span class="number">81206308</span>, -<span class="number">284228457</span>, <span class="number">373369420</span>, <span class="number">659110852</span>, <span class="number">165298084</span>, -<span class="number">389004184</span>,</span><br><span class="line">     <span class="number">893094421</span>, -<span class="number">868933443</span>, <span class="number">44838205</span>, -<span class="number">98551062</span>, -<span class="number">59800920</span>, -<span class="number">575871298</span>, -<span class="number">748337118</span>, <span class="number">696390966</span>, <span class="number">427210246</span>, -<span class="number">266607884</span>,</span><br><span class="line">     -<span class="number">555200820</span>, -<span class="number">594235119</span>, -<span class="number">233255094</span>, <span class="number">229291711</span>, <span class="number">711922719</span>, <span class="number">14476464</span>, -<span class="number">783373820</span>, <span class="number">892608580</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):</span><br><span class="line">    <span class="keyword">for</span> data <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>, <span class="number">0x7f</span>):</span><br><span class="line">        <span class="keyword">if</span> e[i] == (a[i] * data * data + b[i] * data + c[i]):</span><br><span class="line">            print(<span class="built_in">chr</span>(data), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="built_in">len</span>(e))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;bfe043d228d49fffaeb54fe18cf8e118&#125;</span></span><br></pre></td></tr></table></figure>




<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="very-smooth"><a href="#very-smooth" class="headerlink" title="very_smooth"></a>very_smooth</h2><p>通过选择明文攻击恢复n。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210604152355511.png" alt="image-20210604152355511"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&quot;118.190.62.234&quot;</span>,<span class="number">61139</span>)</span><br><span class="line"></span><br><span class="line">charset = string.ascii_letters + string.digits</span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sp</span>(<span class="params">suffix,s256</span>):</span></span><br><span class="line">    <span class="keyword">for</span> a1 <span class="keyword">in</span> charset:</span><br><span class="line">        <span class="keyword">for</span> a2  <span class="keyword">in</span> charset:</span><br><span class="line">            <span class="keyword">for</span> a3 <span class="keyword">in</span> charset:</span><br><span class="line">                <span class="keyword">for</span> a4 <span class="keyword">in</span> charset:</span><br><span class="line">                    result=a1+a2+a3+a4</span><br><span class="line">                    pn=result+suffix</span><br><span class="line">                    sm=hashlib.sha256(pn.encode()).hexdigest()</span><br><span class="line">                    <span class="keyword">if</span> sm==sh256:</span><br><span class="line">                        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">e=p.recvuntil(<span class="string">&quot;sha256(XXXX+&quot;</span>).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">prefix = p.recvuntil(<span class="string">&quot;) == &quot;</span>,drop = <span class="literal">True</span>).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">target = p.recvuntil(<span class="string">&quot;\n&quot;</span>,drop = <span class="literal">True</span>).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">a = sp(prefix,target)</span><br><span class="line">p.send(a)</span><br><span class="line"></span><br><span class="line"><span class="comment">#get n</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;Enter option &gt; &quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Enter your plaintext in hex &gt; &quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;02&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Here is your ciphertext in hex: &quot;</span>)</span><br><span class="line">c1=p.recvuntil(<span class="string">&quot;\n&quot;</span>)[:-<span class="number">1</span>].decode()</span><br><span class="line">print(c1)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Enter option &gt; &quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Enter your plaintext in hex &gt; &quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;04&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Here is your ciphertext in hex: &quot;</span>)</span><br><span class="line">c2=p.recvuntil(<span class="string">&quot;\n&quot;</span>)[:-<span class="number">1</span>].decode()</span><br><span class="line">print(c2)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Enter option &gt; &quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Enter your plaintext in hex &gt; &quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;08&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Here is your ciphertext in hex: &quot;</span>)</span><br><span class="line">c3=p.recvuntil(<span class="string">&quot;\n&quot;</span>)[:-<span class="number">1</span>].decode()</span><br><span class="line">print(c3)</span><br><span class="line"><span class="comment"># c1=0x42a03c9a532106552a1517f833746c75951b9daebc0fd66b616f54622b44f3aec6227a3b4f02f4e77ae98209fa4c52c43596a44468a336d956d69be9588e6544c98313c9e8b4083cc3165102c7704834c66e165971419e17717f98eb0e494c71c498e7c7432a4753329912ec2a60a128e04c93e28c5c253e6ee17c3376f0712fb3b7ae72715f76366eeeb207a5367db8e2f43a5ad33459014bef0d3c225bd11768124a75a54e7c910151cd314ae7bbc4f86fbf6a5f2df7cda7467596bb415d2165ab282c38b2dccd736c3c5f2fea9cf64f417b6340f7d59069f739aa538b6e074fd149a016fc446439a8c2b59d306f748e9abd21a15947f3b31d9cac9c932e9c4d9e639247eaa2345651bf8d741943904c33316b5ebff740f609605ccb0d0069a0e45d230a6af1d12904d998d540387f89529cf8a5c6b491c7bd190ce98120adeab6c6400a735369234655d20dbd1f86213da6bd2ffc07f8c4debc39b33954dc38ac1d897bd58f585f892d35fa9367478f44bc25ac809d3a336aa0a9af3bc7f2661c06cbd414b1a99e1058593a7415135464a10fd0cffa2a5d50bbff9478825075371833996f5f780389b7e466a9545cfbb76fb4cff56addab40c4c043295752a4dbf085cd57e32a44d88c36bd8c71ab55f835a0f54d47db7b1cd9b38dffe4cb2076c7fa38d47ad791e97220c75d795009f933de26d18f19439cb89b1c6eee9b921155</span></span><br><span class="line"><span class="comment"># c2=0x4e0fc3b860cc8b893eb63d23cfb68ac9750e0519e54949f45e5c230d53443758a7f5187fa111399edad5b82d01546cafc756738c4ba8c80f7f5ccd3f0401ce0d494ee6988fbf9995434a35e70ad5271d18f0790dfb7593022927116a0c2dcdea61e25eeabc67da1b22bc0c2f44be8d35da70af6f78696302d5e78e838668eb22240bc8916c2ed9b90c48ba9bc2d610e9019efba6c8a1f63ed204fbed82954582671b7ca8be91411c0ef4dbc918d913ed80a234ca448b298366fcb6dc241ed3d7744cb3bf5d24811a34875a346bfb37e35f3a77cc5f96aa65863ff7aac97142b2d1eb2b73a72a7918b87d99cfd5f3e7adac18c5016e4e41c96d0110570f7a937b3a21d7e94ea0b407b58d87893903b10e6a3088e3a07426e8d41dd197af71ac855e9a6a6e060556b853e2b40aad8d2581732163ca76c938e687f37c30ac48b3dda19e8814c10f852e71421cae9bdd795e0c7a9afb34261900236c586e59469f0cecd9cdfc81ebeeb0bc6e2f19f6dfb949ee00bd4ed8a1a553dc4a145ae415e39aec7f56ad2c5ef1a33f943b126bc8b67fbb632b01eda6e06ce0f847e32218dcfa5f70687e55e8d7d844308d61311077c5cd4b022c42d6bbf0b436542093bf60cd0ce87b7c9bcb3517ae9d0e51d1a2e05cd40a97b469d127714f3c6dd0183956357db25be4c5443ea01aac72ba583d0cd0a72ad4f6fa30d8ace2bbe87f9ff11ddb293539</span></span><br><span class="line"><span class="comment"># c3=0x187adec8ba464a1a8f911caaabd95a519fc641729d0bbaebd6733362313d718d783961d4db0772de7e1f53c0971b630007554d3f82ca74a6879a08b1572688306dc5759182f20009c4c8cd645eba15e8e1ecb90c7b332685eaeeea0fc5e0f358880c78fcee3aed48ffc28798c553ad43ffc09adcf8797a0177b98ee692d32fd5564dadee8756192685a325012aa460802197bfb04118e1444708403d75fec3888097c3289de53b2491323d4c0f11b0cd6242192f8a40fef3dae1cbdc0a70a2cbca2c746ccf40aa261e87c9a22f2205375c88098dc20d9d5093d9a1b79e4dcf3ff8029a62b4391e16c7c106b05def5ccf1b22565d0ce2deb3eb1b4943ca28999b86e815566f55d2a7a0c8c341adcfea7d608690c217c9128dc41c708c0b3830159947618a1860d11e5bb376b14e20017972116da12364cc4ba87a0fc33a02f55fab863ac5f841915c6ec6301cc56ca8c4fe7a37031df7cea4bedec32ca4d24832772aff2363d4ba6c943ce67bad23b4a643ac24e20cfaaada364d1b389409b2f9fd52632cd8b80a9264ef9e637947f80521d95a4c173649e05f6fb5c5ad350293e08e2215cfab6a7dbc7901a112f59209dd030219665438b708f7fcd7add7d9b1ebc4fc1f9abb6bcb3bfcaa757dd6d6853990371ec788ca5a5885fc979e0339f6d63fddff99472d09a1ff2a055add58ff8b3b4302ba0cc0f330c107e084c7bae53af298</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>手动输入2获得公钥文件</p>
<p>解析，提取出</p>
<p>e=12738859322882260979</p>
<p>,通过3得知，生成光滑数，</p>
<p>通过Pollard’s p − 1算法，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c1=<span class="number">0x42a03c9a532106552a1517f833746c75951b9daebc0fd66b616f54622b44f3aec6227a3b4f02f4e77ae98209fa4c52c43596a44468a336d956d69be9588e6544c98313c9e8b4083cc3165102c7704834c66e165971419e17717f98eb0e494c71c498e7c7432a4753329912ec2a60a128e04c93e28c5c253e6ee17c3376f0712fb3b7ae72715f76366eeeb207a5367db8e2f43a5ad33459014bef0d3c225bd11768124a75a54e7c910151cd314ae7bbc4f86fbf6a5f2df7cda7467596bb415d2165ab282c38b2dccd736c3c5f2fea9cf64f417b6340f7d59069f739aa538b6e074fd149a016fc446439a8c2b59d306f748e9abd21a15947f3b31d9cac9c932e9c4d9e639247eaa2345651bf8d741943904c33316b5ebff740f609605ccb0d0069a0e45d230a6af1d12904d998d540387f89529cf8a5c6b491c7bd190ce98120adeab6c6400a735369234655d20dbd1f86213da6bd2ffc07f8c4debc39b33954dc38ac1d897bd58f585f892d35fa9367478f44bc25ac809d3a336aa0a9af3bc7f2661c06cbd414b1a99e1058593a7415135464a10fd0cffa2a5d50bbff9478825075371833996f5f780389b7e466a9545cfbb76fb4cff56addab40c4c043295752a4dbf085cd57e32a44d88c36bd8c71ab55f835a0f54d47db7b1cd9b38dffe4cb2076c7fa38d47ad791e97220c75d795009f933de26d18f19439cb89b1c6eee9b921155</span></span><br><span class="line">c2=<span class="number">0x4e0fc3b860cc8b893eb63d23cfb68ac9750e0519e54949f45e5c230d53443758a7f5187fa111399edad5b82d01546cafc756738c4ba8c80f7f5ccd3f0401ce0d494ee6988fbf9995434a35e70ad5271d18f0790dfb7593022927116a0c2dcdea61e25eeabc67da1b22bc0c2f44be8d35da70af6f78696302d5e78e838668eb22240bc8916c2ed9b90c48ba9bc2d610e9019efba6c8a1f63ed204fbed82954582671b7ca8be91411c0ef4dbc918d913ed80a234ca448b298366fcb6dc241ed3d7744cb3bf5d24811a34875a346bfb37e35f3a77cc5f96aa65863ff7aac97142b2d1eb2b73a72a7918b87d99cfd5f3e7adac18c5016e4e41c96d0110570f7a937b3a21d7e94ea0b407b58d87893903b10e6a3088e3a07426e8d41dd197af71ac855e9a6a6e060556b853e2b40aad8d2581732163ca76c938e687f37c30ac48b3dda19e8814c10f852e71421cae9bdd795e0c7a9afb34261900236c586e59469f0cecd9cdfc81ebeeb0bc6e2f19f6dfb949ee00bd4ed8a1a553dc4a145ae415e39aec7f56ad2c5ef1a33f943b126bc8b67fbb632b01eda6e06ce0f847e32218dcfa5f70687e55e8d7d844308d61311077c5cd4b022c42d6bbf0b436542093bf60cd0ce87b7c9bcb3517ae9d0e51d1a2e05cd40a97b469d127714f3c6dd0183956357db25be4c5443ea01aac72ba583d0cd0a72ad4f6fa30d8ace2bbe87f9ff11ddb293539</span></span><br><span class="line">c3=<span class="number">0x187adec8ba464a1a8f911caaabd95a519fc641729d0bbaebd6733362313d718d783961d4db0772de7e1f53c0971b630007554d3f82ca74a6879a08b1572688306dc5759182f20009c4c8cd645eba15e8e1ecb90c7b332685eaeeea0fc5e0f358880c78fcee3aed48ffc28798c553ad43ffc09adcf8797a0177b98ee692d32fd5564dadee8756192685a325012aa460802197bfb04118e1444708403d75fec3888097c3289de53b2491323d4c0f11b0cd6242192f8a40fef3dae1cbdc0a70a2cbca2c746ccf40aa261e87c9a22f2205375c88098dc20d9d5093d9a1b79e4dcf3ff8029a62b4391e16c7c106b05def5ccf1b22565d0ce2deb3eb1b4943ca28999b86e815566f55d2a7a0c8c341adcfea7d608690c217c9128dc41c708c0b3830159947618a1860d11e5bb376b14e20017972116da12364cc4ba87a0fc33a02f55fab863ac5f841915c6ec6301cc56ca8c4fe7a37031df7cea4bedec32ca4d24832772aff2363d4ba6c943ce67bad23b4a643ac24e20cfaaada364d1b389409b2f9fd52632cd8b80a9264ef9e637947f80521d95a4c173649e05f6fb5c5ad350293e08e2215cfab6a7dbc7901a112f59209dd030219665438b708f7fcd7add7d9b1ebc4fc1f9abb6bcb3bfcaa757dd6d6853990371ec788ca5a5885fc979e0339f6d63fddff99472d09a1ff2a055add58ff8b3b4302ba0cc0f330c107e084c7bae53af298</span></span><br><span class="line">N=gcd(c1*c1-c2,c1*c1*c1-c3)</span><br><span class="line"><span class="keyword">assert</span> N!=<span class="number">1</span></span><br><span class="line">n=<span class="number">2</span></span><br><span class="line">a=<span class="number">2</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a=<span class="built_in">pow</span>(a,n,N)</span><br><span class="line">    res=gmpy2.gcd(a-<span class="number">1</span>,N)</span><br><span class="line">    <span class="keyword">if</span> res!=<span class="number">1</span> <span class="keyword">and</span> res!=N:</span><br><span class="line">        p=res</span><br><span class="line">        q=N//res</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    n=n+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;p=&quot;</span>,p)</span><br><span class="line">print(<span class="string">&quot;q=&quot;</span>,q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#p=22960690030954031643742873940756387805063632374349798184486158679056793968326082353744810859681157004386764888216226590055321262725333525018162946329363305619138731630622888165955977549876211714272441886170151684654308569015065787094352398847347785663643177996671368014667130798343655987811559205747080364736341114890032293368422580223606501359822058596759086093511987824715524940155176294187511558172399888678858130086673199405724632211823726260671253464305495983658956071316594110302935414507198453006409876448274797313564489027777441015454737825659566520679223546384865017468537310551644663582219910328842894601218987465694396182284590994715625131230714161417041725952699878736781345012032174229077433177127599212318839252860698357547341108410217873453860041877707176988034842163129340937209451388376485311961183911455765614162925734677267585939412323019039933618486263931972247343936114712480771059070555737146835361052356166634684179750979833279130369193818863085641945469759413602478617023305793042062127374270238398593152253825771645013808373316824228767738910513983082625750695479978910779636917338424693371960346239509252789852394767480118428666311119275133465046795934573038184768396911187352262509744712465822871605090335322209999</span></span><br><span class="line"><span class="comment">#q=465694396182284590994715625131230714161417041725952699878736781345012032174229077433177127599212318839252860698357547341108410217873453860041877707176988034842163129340937209451388376485311961183911455765614162925734677267585939412323019039933618486263931972247343936114712480771059070555737146835361052356166634684179750979833279130369193818863085641945469759413602478617023305793042062127374270238398593152253825771645013808373316824228767738910513983082625750695479978910779636917338424693371960346239509252789852394767480118428666311119275133465046795934573038184768396911187352262509744712465822871605090335322209999</span></span><br></pre></td></tr></table></figure>


<p>然后就是普通的rsa解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p=<span class="number">22960690030954031643742873940756387805063632374349798184486158679056793968326082353744810859681157004386764888216226590055321262725333525018162946329363305619138731630622888165955977549876211714272441886170151684654308569015065787094352398847347785663643177996671368014667130798343655987811559205747080364736341114890032293368422580223606501359822058596759086093511987824715524940155176294187511558172399888678858130086673199405724632211823726260671253464305495983658956071316594110302935414507198453006409876448274797313564489027777441015454737825659566520679223546384865017468537310551644663582219910328842894601218987</span></span><br><span class="line">q=<span class="number">465694396182284590994715625131230714161417041725952699878736781345012032174229077433177127599212318839252860698357547341108410217873453860041877707176988034842163129340937209451388376485311961183911455765614162925734677267585939412323019039933618486263931972247343936114712480771059070555737146835361052356166634684179750979833279130369193818863085641945469759413602478617023305793042062127374270238398593152253825771645013808373316824228767738910513983082625750695479978910779636917338424693371960346239509252789852394767480118428666311119275133465046795934573038184768396911187352262509744712465822871605090335322209999</span></span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line">c=<span class="number">0x17bb4730ef3ba7591d5ac5aba56596ea7bb5b3cac908375fed01f827a4ad246457bcf4f67be416126bc421b2ec813aca9ebed52c36734be35fd39fd450bd11831f833053743c7822094bf295d17984380d062764f31c8e8725255eec779d375ec82b76b6d8956107264fd9550d0f7407ad6531bbbc79af22cb85191171e0a79c137f180d9376cce93e9a17fb1d7ba985150f73b8d67be7e47c72bf607aa274369aaaa230078eca1bf4daa0326d46b682b1d94c651946417f7f254c1b6531df833deca73b81d9cf026c5038c8021d31fee10efb4a1f041d9180b7b489a9ce0ea12f82c67529c9088f72e84de35aa48ebfd67e7a8fcaf01b07a937bbeeab578710495abcc80f8a2a57a84d5b76e54cd58d160f6e289bf4848b9b87c7b94164fd11b3dca467074a71e02ed9ea72db34915e1276c48339ef6f4c4a9e971e69041117b6a1f2502a475dfbba83b1c61d1b7e427c0de5132f82b73b0ba839bfe4ad93cb8768596d67aa2dfb873a7589d38a89cae70203e9fdbcd2497adf563480ad03163c96be553ba5f72ad2d57358acd9ebeeb00b2a023f5a9406b5549082a618e43773b903d501bd6aab795362dc49024c2a6a17ba33d13731aea574941766dd1a52c3f3d48f9e26901d4e1c3031ba1cd63c5078bc51d3b0f310236d3d2b9e8a9fa4fa01567293e02ef22dea9d3744924f46e5f16f25ad800f3fa93a5f4c4b58c68bbac1</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">12738859322882260979</span></span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"><span class="comment">#flag&#123;984af69b-5497-471b-9fa3-cda517490ad2&#125;</span></span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2021/06/13/qwb-re/" class="prev">PREV</a><a href="/2021/06/01/%E7%AC%AC%E4%BA%8C%E5%B1%8A-newsctf/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2021 <a href="http://example.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>