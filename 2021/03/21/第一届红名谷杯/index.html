<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 第一届红名谷杯 · H-Lither</title><meta name="description" content="第一届红名谷杯 - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://example.com/atom.xml" title="H-Lither"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="H-Lither" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">第一届红名谷杯</h1><div class="post-info">Mar 21, 2021</div><div class="post-content"><h1 id="第一届红名谷杯"><a href="#第一届红名谷杯" class="headerlink" title="第一届红名谷杯"></a>第一届红名谷杯</h1><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>答题全对即可获得flag</p>
<h3 id="歪比歪比"><a href="#歪比歪比" class="headerlink" title="歪比歪比"></a>歪比歪比</h3><p>分析文件：</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210402215746810.png" alt="image-20210402215746810"></p>
<p>尝试后发现字符后面相加是1000个数，然后下面是他加密的信息</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210402215818062.png" alt="image-20210402215818062"></p>
<p>可以想到ascii发现，不是1000转换后不是1000个数，转换进制，也凑不齐1000个数，然后突然想到上周DASCTF的一道misc题有用到字频和01编码，改脚本，尝试哈夫曼。得出flag。改自一个大佬博客雾岛孤儿的<a target="_blank" rel="noopener" href="http://www.fzwjscj.xyz/index.php/archives/41/#flag-2">wp</a>的脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Huffman Encoding</span></span><br><span class="line"><span class="comment">#Tree-Node Type</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,freq</span>):</span></span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line">        self.father = <span class="literal">None</span></span><br><span class="line">        self.freq = freq</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isLeft</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.father.left == self</span><br><span class="line"><span class="comment">#create nodes创建叶子节点</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createNodes</span>(<span class="params">freqs</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [Node(freq) <span class="keyword">for</span> freq <span class="keyword">in</span> freqs]</span><br><span class="line"></span><br><span class="line"><span class="comment">#create Huffman-Tree创建Huffman树</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createHuffmanTree</span>(<span class="params">nodes</span>):</span></span><br><span class="line">    queue = nodes[:]</span><br><span class="line">    print(queue) <span class="comment">#一个个node的地址</span></span><br><span class="line">    <span class="comment">#每次对queue进行排序，</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(queue) &gt; <span class="number">1</span>:</span><br><span class="line">        queue.sort(key=<span class="keyword">lambda</span> item:item.freq) <span class="comment">#reverse = false</span></span><br><span class="line">        node_left = queue.pop(<span class="number">0</span>)</span><br><span class="line">        node_right = queue.pop(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        node_father = Node(node_left.freq + node_right.freq)</span><br><span class="line"></span><br><span class="line">        node_father.left = node_left</span><br><span class="line">        node_father.right = node_right</span><br><span class="line">        node_left.father = node_father</span><br><span class="line">        node_right.father = node_father</span><br><span class="line">        queue.append(node_father)</span><br><span class="line">    queue[<span class="number">0</span>].father = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> queue[<span class="number">0</span>]</span><br><span class="line"><span class="comment">#Huffman编码</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">huffmanEncoding</span>(<span class="params">nodes,root</span>):</span></span><br><span class="line">    codes = [<span class="string">&#x27;&#x27;</span>] * <span class="built_in">len</span>(nodes)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nodes)):</span><br><span class="line">        node_tmp = nodes[i]</span><br><span class="line">        <span class="keyword">while</span> node_tmp != root:</span><br><span class="line">            <span class="keyword">if</span> node_tmp.isLeft():</span><br><span class="line">                codes[i] = <span class="string">&#x27;0&#x27;</span> + codes[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                codes[i] = <span class="string">&#x27;1&#x27;</span> + codes[i]</span><br><span class="line">            node_tmp = node_tmp.father</span><br><span class="line">    <span class="keyword">return</span> codes</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">freq_count</span>(<span class="params">strr</span>):</span></span><br><span class="line">    chars = []</span><br><span class="line">    chars_fre = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(strr)):</span><br><span class="line">        <span class="keyword">if</span> strr[i] <span class="keyword">in</span> chars:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            chars.append(strr[i])</span><br><span class="line">            char_fre = (strr[i], strr.count(strr[i]))</span><br><span class="line">            <span class="comment"># print(chars_fre)</span></span><br><span class="line">            chars_fre.append(char_fre)</span><br><span class="line">    <span class="keyword">return</span> chars_fre</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encoder_huffman</span>(<span class="params">strr,chars_fre,codes</span>):</span></span><br><span class="line">    huffmans=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> strr:</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="comment">#用于与code【i】还有item 的符号一一对应</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> chars_fre:</span><br><span class="line">            <span class="keyword">if</span> word == item[<span class="number">0</span>]:</span><br><span class="line">                huffmans += codes[i]</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">    print(huffmans)</span><br><span class="line">    <span class="keyword">return</span> huffmans</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_huffman</span>(<span class="params">huffmans,codes,chars_fre</span>):</span></span><br><span class="line">    original_code=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> huffmans!=<span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        i=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> codes:</span><br><span class="line">            <span class="keyword">if</span> item <span class="keyword">in</span> huffmans:</span><br><span class="line">                <span class="keyword">if</span> huffmans.index(item) ==<span class="number">0</span>:</span><br><span class="line">                    original_code += chars_fre[i][<span class="number">0</span>]</span><br><span class="line">                    huffmans=huffmans[<span class="built_in">len</span>(item):]</span><br><span class="line">            i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> original_code</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#chars = [&#x27;A&#x27;,&#x27;B&#x27;,&#x27;C&#x27;,&#x27;D&#x27;,&#x27;E&#x27;,&#x27;F&#x27;,&#x27;G&#x27;,&#x27;H&#x27;,&#x27;I&#x27;,&#x27;J&#x27;,&#x27;K&#x27;,&#x27;L&#x27;,&#x27;M&#x27;,&#x27;N&#x27;]</span></span><br><span class="line">    <span class="comment">#freqs = [10,4,2,5,3,4,2,6,4,4,3,7,9,6]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#元组的列表，item【1】就是后面2，2，3，4，等，生成器然后是作为列表保存，传入createnodes中</span></span><br><span class="line">   <span class="comment"># &#x27;&#x27;&#x27;&#x27;&#x27;&#x27;chars_freqs = [(&#x27;C&#x27;, 2), (&#x27;G&#x27;, 2), (&#x27;E&#x27;, 3), (&#x27;K&#x27;, 3), (&#x27;B&#x27;, 4),</span></span><br><span class="line">   <span class="comment">#                 (&#x27;F&#x27;, 4), (&#x27;I&#x27;, 4), (&#x27;J&#x27;, 4), (&#x27;D&#x27;, 5), (&#x27;H&#x27;, 6),</span></span><br><span class="line">   <span class="comment">#                 (&#x27;N&#x27;, 6), (&#x27;L&#x27;, 7), (&#x27;M&#x27;, 9), (&#x27;A&#x27;, 10)]</span></span><br><span class="line">   <span class="comment"># &#x27;&#x27;&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">if</span> __name__ ==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment">#sttttt =input(&#x27;input your text&#x27;)</span></span><br><span class="line">    <span class="comment">#sttttt=input(&#x27;input your text&#x27;)</span></span><br><span class="line">    <span class="comment"># sttttt=&quot;&quot;</span></span><br><span class="line">    <span class="comment"># sttttt = open(&#x27;docx复制粘贴出来的文本&#x27;,&#x27;r&#x27;).read()</span></span><br><span class="line">    <span class="comment"># for i in range(100):</span></span><br><span class="line">    <span class="comment">#     sttttt += str(int(random.randint(27, 70)))</span></span><br><span class="line">    <span class="comment">#     sttttt += random.choice(&#x27;abcdefghijklmnopqrstuvwxyz!@#$%^&amp;*()&#x27;)</span></span><br><span class="line">    <span class="comment"># sttttt=random.sample(</span></span><br><span class="line">    <span class="comment">#     [&#x27;z&#x27;, &#x27;y&#x27;, &#x27;x&#x27;, &#x27;w&#x27;, &#x27;v&#x27;, &#x27;u&#x27;, &#x27;t&#x27;, &#x27;s&#x27;, &#x27;r&#x27;, &#x27;q&#x27;, &#x27;p&#x27;, &#x27;o&#x27;, &#x27;n&#x27;, &#x27;m&#x27;, &#x27;l&#x27;, &#x27;k&#x27;, &#x27;j&#x27;, &#x27;i&#x27;, &#x27;h&#x27;, &#x27;g&#x27;, &#x27;f&#x27;, &#x27;e&#x27;,</span></span><br><span class="line">    <span class="comment">#      &#x27;d&#x27;, &#x27;c&#x27;, &#x27;b&#x27;, &#x27;a&#x27;],20)</span></span><br><span class="line">   <span class="comment"># print(sttttt)</span></span><br><span class="line">    <span class="comment"># print(&#x27;编译前输入的文本：    &#x27;+sttttt)</span></span><br><span class="line">    <span class="comment">#chars_freqs=freq_count(sttttt)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#c=input(&#x27;input your word and freq, splitted with ,&#x27;)</span></span><br><span class="line">    <span class="comment">#splitt = c.split(&#x27;,&#x27;)</span></span><br><span class="line">    <span class="comment">#print(splitt)</span></span><br><span class="line">    chars_freqs =[(<span class="string">&#x27;j&#x27;</span>, <span class="number">29</span>), (<span class="string">&#x27;z&#x27;</span>, <span class="number">31</span>), (<span class="string">&#x27;7&#x27;</span>, <span class="number">25</span>), (<span class="string">&#x27;e&#x27;</span>, <span class="number">31</span>), (<span class="string">&#x27;l&#x27;</span>, <span class="number">23</span>),</span><br><span class="line">                    (<span class="string">&#x27;6&#x27;</span>, <span class="number">37</span>), (<span class="string">&#x27;4&#x27;</span>, <span class="number">32</span>), (<span class="string">&#x27;p&#x27;</span>, <span class="number">38</span>), (<span class="string">&#x27;h&#x27;</span>, <span class="number">27</span>), (<span class="string">&#x27;g&#x27;</span>, <span class="number">26</span>),</span><br><span class="line">                    (<span class="string">&#x27;x&#x27;</span>, <span class="number">28</span>), (<span class="string">&#x27;i&#x27;</span>, <span class="number">25</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="number">27</span>),</span><br><span class="line">                  (<span class="string">&#x27;n&#x27;</span>, <span class="number">25</span>), (<span class="string">&#x27;8&#x27;</span>, <span class="number">36</span>), (<span class="string">&#x27;0&#x27;</span>, <span class="number">24</span>),(<span class="string">&#x27;o&#x27;</span>, <span class="number">23</span>),</span><br><span class="line">                  (<span class="string">&#x27;c&#x27;</span>, <span class="number">28</span>),(<span class="string">&#x27;y&#x27;</span>, <span class="number">24</span>),(<span class="string">&#x27;1&#x27;</span>, <span class="number">29</span>),</span><br><span class="line">                  (<span class="string">&#x27;b&#x27;</span>, <span class="number">26</span>), (<span class="string">&#x27;m&#x27;</span>,<span class="number">27</span>), (<span class="string">&#x27;2&#x27;</span>,<span class="number">28</span>), (<span class="string">&#x27;v&#x27;</span>,<span class="number">25</span>), (<span class="string">&#x27;d&#x27;</span>,<span class="number">33</span>),</span><br><span class="line">                  (<span class="string">&#x27;f&#x27;</span>, <span class="number">28</span>), (<span class="string">&#x27;9&#x27;</span>,<span class="number">33</span>), (<span class="string">&#x27;t&#x27;</span>,<span class="number">21</span>), (<span class="string">&#x27;w&#x27;</span>,<span class="number">22</span>), (<span class="string">&#x27;a&#x27;</span>,<span class="number">31</span>),</span><br><span class="line">                  (<span class="string">&#x27;r&#x27;</span>, <span class="number">24</span>), (<span class="string">&#x27;s&#x27;</span>,<span class="number">16</span>), (<span class="string">&#x27;k&#x27;</span>,<span class="number">32</span>), (<span class="string">&#x27;5&#x27;</span>,<span class="number">25</span>), (<span class="string">&#x27;q&#x27;</span>,<span class="number">23</span>),</span><br><span class="line">                  (<span class="string">&#x27;3&#x27;</span>, <span class="number">32</span>), (<span class="string">&#x27;&#123;&#x27;</span>,<span class="number">1</span>), (<span class="string">&#x27;-&#x27;</span>,<span class="number">4</span>), (<span class="string">&#x27;&#125;&#x27;</span>,<span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&#x27;文本中字符的统计如下：\n&#x27;</span>+<span class="built_in">str</span>(chars_freqs))</span><br><span class="line">    <span class="comment"># for i in range(0,len(sttttt),2):</span></span><br><span class="line">    <span class="comment">#     chars_freq=   (sttttt[i], sttttt[i+1])</span></span><br><span class="line">    <span class="comment">#     if sttttt[i] in [item[0] for item in chars_freqs]:</span></span><br><span class="line">    <span class="comment">#         print(&#x27;can not be  a huffman code, there is some word repeating in this sentence, the huffman code will be without:&#x27;,sttttt[i],sttttt[i+1])</span></span><br><span class="line">    <span class="comment">#         continue</span></span><br><span class="line">    <span class="comment">#     chars_freqs.append(chars_freq)</span></span><br><span class="line">    <span class="comment"># print(chars_freqs)</span></span><br><span class="line">    nodes = createNodes([item[<span class="number">1</span>] <span class="keyword">for</span> item <span class="keyword">in</span> chars_freqs])</span><br><span class="line">    <span class="comment">#print([item[1] for item in chars_freqs])</span></span><br><span class="line">    root = createHuffmanTree(nodes)</span><br><span class="line">    codes = huffmanEncoding(nodes,root)</span><br><span class="line">    print(codes)</span><br><span class="line">    res = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> <span class="built_in">zip</span>(chars_freqs,codes):</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;Character:%s freq:%-2d   encoding: %s&#x27;</span> % (item[<span class="number">0</span>][<span class="number">0</span>],item[<span class="number">0</span>][<span class="number">1</span>],item[<span class="number">1</span>]))</span><br><span class="line">        res.update(&#123;item[<span class="number">1</span>]:item[<span class="number">0</span>][<span class="number">0</span>]&#125;)</span><br><span class="line">    huffman_code=<span class="string">&#x27;0111110001000011001010001111011110101010011011011110100000110010111101000010010010001100001110010000011110011101101111011001111101000000111010100000101101001000111100000000010100110100101001011101110010001100011100010010111001100011100110011010011000101010100011011110001111111110111001011100010100101111100001011011001001001000010111110101110111010111100010111011000011001011001101001010010111111001110101000110001001001100101110111101111000110010010111111000111110000101001100100100001001110100101011111101111110011101011101000000100100100011111111001000101110101001001101110001011101101001001001011010000101111111001011111100110010100111111110001001100100010010010011110111110110110001101000010010110110001011010000100011010111110101110000110000010001111111110000101000100101101111000111100101101011001100010101011000110010011111001010011110100100011000101111110111011011000011011010100011011100010001010001010000000001101001010010100111111010010110110011110100101010010101001010100010101011010011110001000011000100001010111001110001100101100001010111011110110111110000001011011111011101101000111111110100111100110011101111100111100101101101101010100110001100100110101011110000011111111100011110011101010011110101010111100111100001000111110111110100010011110011000010000100001100101111101010110101100011100010010100001110001001010110010010010100010101101101001110000101111110101010110110110000010011000111000010001001101101101101100111000011000011010101111010101100101000011011001011000101101110100011110001100111101111011000100110110000111010101101111101001111111111100001000111000001001011111011110010110101011110001110001101010011000101111100001111111011100110101001000011111101111111011001111110001110111110110010111000111011011110010101010110011001110110011110001111010000011010101000111110111011100101100100100100001111101010011101111100110011100000010100101000111100100011001011111000000111111111000000011111111101110111111001110100100000100000011011111010000000011110101110111101101011001111011010101111000010110001101000111000111000001110110111000100011110101100100100011100111100101101010010110101011111110011100100000111011011010101101110111000001001100110111001000111001000000111000110010110000100100010001001111010101000101101111000000110101110011101001011100110111101101111100001111000110001101010000111100100011110001100110111001101011100010101011110111111111100101100101010001101110101101101010101001110100001101011000100001111011011100101011000001001000011011000111011101110011001101110100000010100000101111010000001000011001101101111010011101000000101101101011101001101110000010011110001110100111000101111101010110111010011010011000011000110110010110001001000101101111000010010001011110100010111010100101100101111010100001110111100000100101101011110010110001000111111001000000101110010111010001101101111101110111000010101100100001010101001010010001011101001100101010101001111110000010011010011110101001001001110010110100111011110110000111101000010011111000111111001111010011101011010011100010001111101001110011110101111111111111011010100000010100010010011110100110011011101011101011101100000100111110111100100000101011000110110000010110001001111111111011101011000010101111110111001011101111111100111011101001000111011110110111101001011110011000110011000010011011001001100010010111110000110100001110111100110110100101010010111001001100101111010010001001111111000010111101010110000001110101000111011010111100110101001001110001110001001111110001000010011011110100111011111000101111110011000011010001000101000110011100011001001011000111011100101101000110001110011011101010101001010011101110100100111101011101010011010101010111101110101101000001111100111111010011010111101000101011111101011100101101101001100011001111101111100100111101101101110111111010111010100100101110111000011100001001000011100010101110100111110011001100101111110110100111101000010001000011011110000011010110111010110001110011111110000011110010001011010010111111101010101110010000001010011111011100101000101101010101101101000101000110011101101010110001100101011101110111100000001010000011110011010011000011111110100111011100100111000001101001110111100000101010110000010000100001110111000011111110010010100111111101010110000000000111011010000101100100111001110000001011101100000110110101011001011000111001111110010101111001011011101000010001100011101110010100111000011111001110001100111110110111101010101011001000101011010001100000010001111110011001101111111010110010001111001100111110001110011100010011011100100010011011000110000100101111100111110111101010010001101010011100110001011001111000100011011110100011101011101010111111110000011110110111011110000010111100110011100011010111101111110100000010001111100101100011110001101011111101111111011111011101010001101001000111000101111110101000110011000111011111101111110100001111011110010100011101110111111010101100111000101100100010011101001011110011111001111101110001110111111011100111100010110010011011010100011100101010101010110000001010111001101111100111110010100111000010101111001110011011011111001101110011111001000000000111101011000111110001101010011011000010100100100111011111110010000000101001111111110101100001010000001110100101001111001011011001001001011100101111110&#x27;</span></span><br><span class="line">    <span class="comment"># print(&#x27;转换之后的huffman编码  &#x27;+huffman_code)</span></span><br><span class="line">    print(<span class="string">&#x27;解码之后的原来的文本：  &#x27;</span>+decode_huffman(huffman_code,codes,chars_freqs))</span><br><span class="line"><span class="comment">#jz7ezl64pjhgx6iun78roljc01bm72vjr7u44dfh9tewz8auzmzdzypet4d9xcehxspktdcgxgeeybmgva5pp9850b9mceifedlos6rehy8isvpzf6u545y50c4y9avuvqq3g1epi6igd6tciby7hep9o33cm3guo4qvcxqpcg6zdi5i1r6mmj6xcq5ummzm6jiniidbn51kppj15dp3zy4o8pww23kggukjrytosbkx8th00zba777e0kkz9e1te3u5i36fiym3pran1zgp2a192x63mnc35dhocqli21s2qby9htvdp82x9t6ai0n0wkvbl080bj3xzpj5m8a3jn67kh0le8v104lwa155n8n5o7y97ypdw6hv7d6rbkppxb3ktxnhttb29zsehww2u2x0fhb2k2p1uafhwrfgx7vha64xjr2ffewd30n9961ozt8dgdikly8cknf36kbh2chj28xrencflag&#123;5rd477a2-6r36-dra9-9d6349c2e9e5d1e5&#125;f43x61l9v3de9z0hiwfz30l1keik5vx48m4yrausvae6fq1q7b9yb4s4tzqbbkyy2hizvqg26spral8rkz37cuylk1k0wfy8p4zppjujggcvpv9e0nhfopumxecd4zbo5sc76zpx8kvttaohud4ltdw16vmgfgucfw2nnafkuup4a6sgkxpk4nw0ax65j6w2498qoap2pqf4el1tu79k6jagxq4q7injr6pkz8yroz25ymdv7uq8h3k24mgf63gmld1i1jga7yupef74l95xr11l1yemjscrn313u89ilrpm8cfj8x826igbfmfnw98qdkm8i3z1vj8ajsebab9w9afhaccvd8qsv2u8zcohp6bxkjonpfoio896q01vje9o2jp00snunzj6zandlq7l8hldsct3ha4dawq9lq8t3u34fmkxrmwd8o4tmow3028o1rqcjzkg9mubjwr5byx7hn44o38vd50</span></span><br></pre></td></tr></table></figure>
<p>中间出现flag</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210402222842566.png" alt="image-20210402222842566"></p>
<p>flag{5rd477a2-6r36-dra9-9d6349c2e9e5d1e5}</p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="RSA-attack"><a href="#RSA-attack" class="headerlink" title="RSA attack"></a>RSA attack</h3><p>出题人太想当然了，没有对明文填充，导致e=3时候，c过短，N过大，直接开e次方，即可得到flag.</p>
<p>m^e=kn+c,k=0</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c=<span class="number">15839981826831548396886036749682663273035548220969819480071392201237477433920362840542848967952612687163860026284987497137578272157113399130705412843449686711908583139117413</span></span><br><span class="line">n=<span class="number">28592245028568852124815768977111125874262599260058745599820769758676575163359612268623240652811172009403854869932602124987089815595007954065785558682294503755479266935877152343298248656222514238984548734114192436817346633473367019138600818158715715935132231386478333980631609437639665255977026081124468935510279104246449817606049991764744352123119281766258347177186790624246492739368005511017524914036614317783472537220720739454744527197507751921840839876863945184171493740832516867733853656800209669179467244407710022070593053034488226101034106881990117738617496520445046561073310892360430531295027470929927226907793</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">m=iroot(c,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b&#x27;flag&#123;w0_x1hu1n_y0u_b5st&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="ezCRT"><a href="#ezCRT" class="headerlink" title="ezCRT"></a>ezCRT</h3><p>五维格。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n1 =<span class="number">92568419674731290088321621356482160506897805615722568594108449347104924357404183476911642777855820991398881156764068184840768873749718093598712551142529474514837161712525386555067489900887826033760157015587905876891826276883359425048106383489316555600680137377034136599761900203863336332834524981581608546277</span> </span><br><span class="line">n2 =<span class="number">156396473818563541024482014372866929605198443382524196879362284224099117401220679011156723462510565131555949471059964179767945960498473012008220045105490122503438703770112687917922899337041421537937431868908340506324082719417747902320117904166584374628828367801012533926776313544525573302674702867896838756349</span></span><br><span class="line">n3=<span class="number">158394833243620345170313957479796081390446308753163267294427471181012679879060921676287361174926310080500003540773261012005682050743188110335872216992843352902160171999286576526304619756655278142788064189969927027027650043645613441449926633380809295720977302961310978360575684689811662689798196832145977450067</span></span><br><span class="line">n4=<span class="number">160088237013152996062303719345275590040820298863729670660621544625451638541931139026114480452748397901155923890465415946150076272684251867169893163248736673419035618274961179288085209456220719404244194802327491684233804878013160262798831738441790443743813368173495029170393018727204042599457829167334217403039</span></span><br><span class="line">n5=<span class="number">176125361422384852665447804150030174008849487020728296169340093618559367127086381778331613043595010796295772394708222184703701230685609172767761426620379001062695169120599393984950488304290958534830276649464003949555105491117656796777657620812669612752464591728873199832200616338112460100967288829163217253937</span></span><br><span class="line">e1 =<span class="number">69312028009355287369151190914681978515224902099126626288106202481561083869512381976466800912049172557479956400189281179789850182367192324370292880508005951892909864237831856642160554901550928757105750738313195248541515727624216048436593804176317465366380022764459799506858495981817822670957526705611211712923</span> </span><br><span class="line">e2 =<span class="number">75652848678989239962391202584125835503829570694373189157636155436633908234362973839251550542975725789188895010096917574118924190081886365041870173203566890015476761857546914959928731140619341634983144909962106759048918025248827973161384045263311189477657141886093632791593341193393085433749877270828641736687</span></span><br><span class="line">e3=<span class="number">33787880341418355427411601538315129862488529656310145182009801227014512555036822623215545927750632031483856865027938518144081751233475248361490189179988637342429805607352670543555743822390555949569061340741015073482051059972283793490798701339277926430357560613555427570475360496737455291914090967005368044847</span></span><br><span class="line">e4=<span class="number">45894271603047945281790624112313938740541711331584775481261776728213544262108835859642003140814571796838418889270625806159755478669858113687476417240730385707171289922064965084283027730393146219788228689778873266618663473231744646293406030907691363263939114550226424730102211751706087680590823466426973879111</span></span><br><span class="line">e5=<span class="number">39462780066564051085365889083337472288277223628014907704844994419242541623368920096395581667207909872944692627394665038729398405841875334128211337544205143876652949004817962123951132753801707134333132359039376283331685997619531570270269964807335633423631078057345827010794671894948828680193958561375351954627</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">M=iroot(<span class="built_in">int</span>(n1),<span class="built_in">int</span>(<span class="number">2</span>))[<span class="number">0</span>]</span><br><span class="line">a=[<span class="number">0</span>]*<span class="number">6</span></span><br><span class="line">a[<span class="number">0</span>]=[M,e1,e2,e3,e4,e5]</span><br><span class="line">a[<span class="number">1</span>]=[<span class="number">0</span>,-n1, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">2</span>]=[<span class="number">0</span>,<span class="number">0</span>,-n2,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">3</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n3,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">4</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n4,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">5</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n5]</span><br><span class="line"></span><br><span class="line">Mat = matrix(ZZ,a)</span><br><span class="line">Mat_LLL=Mat.LLL()</span><br><span class="line">d = <span class="built_in">abs</span>(Mat_LLL[<span class="number">0</span>][<span class="number">0</span>])//M</span><br><span class="line">print(long_to_bytes(d))</span><br><span class="line"><span class="comment">#b&#x27;flag&#123;9b73a84b-5e32-433a-bc8f-6f8a6d2793db&#125;paddip\x0f&#x27;</span></span><br></pre></td></tr></table></figure>
<p>flag{9b73a84b-5e32-433a-bc8f-6f8a6d2793db}</p>
<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="g0"><a href="#g0" class="headerlink" title="g0"></a>g0</h3><p>跟踪flag。观察flag变换。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210721232934366.png" alt="image-20210721232934366"></p>
<p>发现flag首先经过一个移位操作：根据显示，该操作为原[5:10]移动到[0:5],[0:5]移动到[15:20],[15:20]移动到[5:10],[10:15]不变。</p>
<p>然后下面经过一个main_Encode的操作。</p>
<p>加密出来是一串编码。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210721232919896.png" alt="image-20210721232919896"></p>
<p>进入该函数看看，调试到此处。发现</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210721232913946.png" alt="image-20210721232913946"></p>
<p>qword_5C92C8为一个固定值58，</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210721232907130.png" alt="image-20210721232907130"></p>
<p>off_5C92C0偏移指向一个表。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210721232900634.png" alt="image-20210721232900634"></p>
<p>，，，猜了一个换表base58,拿去网站解我们刚才加密的，发现</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210721232849275.png" alt="image-20210721232849275"></p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210721232835749.png" alt="image-20210721232835749"></p>
<p>刚好就是我们输入的还是移位后的</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210721232821149.png" alt="image-20210721232821149"></p>
<p>那么只需要找到比对明文就行了，从主函数后面分析找密文。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210721232812260.png" alt="image-20210721232812260"></p>
<p>进入发现一个比较函数</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210721232803338.png" alt="image-20210721232803338"></p>
<p>猜猜a2gvdudkyo2cbxo就是比对的值，发现该值过长，然后在上面的判断中发现，v17=28。那就取前28的值进行解码。</p>
<p><img src="https://13-1301107080.cos.ap-guangzhou.myqcloud.com/image-20210721232752049.png" alt="image-20210721232752049"></p>
<p>成功得到换表后字符串</p>
<p>最后根据上面分析的方法手动还原一下。</p>
<p>得到flag：</p>
<p>flag{We1CTFc0m_2345}</p>
</div></article></div></main><footer><div class="paginator"><a href="/2021/03/22/NepCTF2021-wp/" class="prev">PREV</a><a href="/2021/03/14/VNCTF2021-wp/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2021 <a href="http://example.com">John Doe</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>